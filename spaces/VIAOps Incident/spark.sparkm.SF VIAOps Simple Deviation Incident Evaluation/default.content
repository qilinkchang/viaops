<DataPipeModel description="Provide subflow for simple deviation incident calculation." name="SF VIAOps Simple Deviation Incident Evaluation" editBy="flow" is_init="false" useStreaming="auto" durableStreaming="false" streamingAutoStart="false" useHive="auto" batchDuration="P1M" runAsService="false" checkpoint="" batchSampling="true" sparkMasterHost="">
  <HiveConfig>
    <Properties>
      <Property name="hive.warehouse.hdfs.source" value=""/>
      <Property name="hive.metastore.data.source" value=""/>
      <Property name="hive.server2.thrift.port" value=""/>
      <Property name="hive.db.schema" value=""/>
    </Properties>
  </HiveConfig>
  <ModelInfo validated="true">
    <Pipes>
      <Pipe index="1000" uuid="" name="(main)">
      </Pipe>
    </Pipes>
    <Flows>
      <Flow index="1000" uuid="Main" isNested="false" revision="0" name="Main" showFooter="true">
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[]</Properties>
      </Flow>
      <Flow index="2000" uuid="Simple Deviation Evaluation" isNested="true" revision="592" acceptedSourceTypes="DStream" registered="true" subflowPath="viaops.incident" name="Simple Deviation Evaluation" showFooter="true">
        <Node index="2001" uuid="5721106c-efe5-428b-8015-f3a4876ab73e" type="Compute" label="Normalize Incident Interface" x="260" y="28" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.incident_score_anomaly">
              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="7f8c7344-1ca8-4043-8fcd-1df9d8ab1cb7">
                <Field name="high_metric_deviation" label="high_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="high_metric_deviation"/>
                <Field name="med_metric_deviation" label="med_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="med_metric_deviation"/>
                <Field name="metric_base_metric_id" label="metric_base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_dim_values" label="metric_dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="anomaly_interval" label="anomaly_interval" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_measure" label="metric_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_baseline" label="metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="date_key" label="date_key" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_metric_id" label="config_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="metric_id"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="threshold_policy"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="algorithm"/>
                <Field name="emit_notification" label="emit_notification" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="emit_notification"/>
                <Field name="threshold_high" label="threshold_high" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="threshold_high"/>
                <Field name="threshold_low" label="threshold_low" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="threshold_low"/>
                <Field name="high_threshold_period" label="high_threshold_period" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="high_threshold_period"/>
                <Field name="expire_after" label="expire_after" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="expire_after"/>
                <Field name="cool_down_period" label="cool_down_period" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="cool_down_period"/>
                <Field name="warmup_period" label="warmup_period" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="warmup_period"/>
                <Field name="warmup_threshold" label="warmup_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="warmup_threshold"/>
                <Field name="min_metric_vol" label="min_metric_vol" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="min_metric_vol"/>
                <Field name="causation_measure" label="causation_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="causation_measure"/>
                <Field name="causation_top_count" label="causation_top_count" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="causation_top_count"/>
                <Field name="causation_min_measure" label="causation_min_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="causation_min_measure"/>
                <Field name="causation_rule_name" label="causation_rule_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="causation_rule_name"/>
                <Field name="upd_dt" label="upd_dt" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="upd_dt"/>
                <Field name="config_dim_pattern" label="config_dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="dim_pattern"/>
                <Field name="service_name" label="service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="service_name"/>
                <Field name="sub_service_name" label="sub_service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="sub_service_name"/>
                <Field name="correlation_time" label="correlation_time" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="correlation_time"/>
                <Field name="groupable" label="groupable" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="groupable"/>
                <Field name="config_base_metric_id" label="config_base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="base_metric_id"/>
                <Field name="metric_hist_per" label="metric_hist_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="metric_hist_per"/>
                <Field name="max_low_per" label="max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="max_low_per"/>
                <Field name="max_med_per" label="max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="max_med_per"/>
                <Field name="tot_max_low_per" label="tot_max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="tot_max_low_per"/>
                <Field name="tot_max_med_per" label="tot_max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="tot_max_med_per"/>
                <Field name="med_threshold_period" label="med_threshold_period" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="med_threshold_period"/>
                <Field name="mode" label="mode" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="mode"/>
                <Field name="min_metric_deviation" label="min_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="min_metric_deviation"/>
                <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="contextual_metric_time_skew"/>
                <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="min_contextual_metric_vol"/>
                <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="min_contextual_metric_deviation"/>
                <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="med_contextual_metric_deviation"/>
                <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="high_contextual_metric_deviation"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="window"/>
                <Field name="threshold_med" label="threshold_med" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="threshold_med"/>
                <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="causation_suppl_measure"/>
                <Field name="min_factor" label="min_factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="min_factor"/>
                <Field name="med_factor" label="med_factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="med_factor"/>
                <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="score_method"/>
                <Field name="max_warmup_period" label="max_warmup_period" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="max_warmup_period"/>
                <Field name="late_data_timer" label="late_data_timer" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="late_data_timer"/>
                <Field name="kpi_metric_id" label="kpi_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="kpi_metric_id" wrapName="kpi_metric_id"/>
                <Field name="kpi_base_metric_id" label="kpi_base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="kpi_base_metric_id" wrapName="kpi_base_metric_id"/>
                <Field name="kpi_dim_keys" label="kpi_dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="kpi_dim_keys" wrapName="kpi_dim_keys"/>
                <Field name="kpi_dim_pattern" label="kpi_dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="kpi_dim_pattern" wrapName="kpi_dim_pattern"/>
                <Field name="contextual_metric_id" label="contextual_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="contextual_metric_id" wrapName="contextual_metric_id"/>
                <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_mean_baseline" label="contextual_metric_mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.incident_in">
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="window" label="window" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="threshold_policy" label="threshold_policy" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="mode" label="mode" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="emit_notification" label="emit_notification" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="anomaly_interval" label="anomaly_interval" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="threshold_high" label="threshold_high" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_low" label="threshold_low" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_med" label="threshold_med" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="med_threshold_period" label="med_threshold_period" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="high_threshold_period" label="high_threshold_period" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="expire_after" label="expire_after" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="cool_down_period" label="cool_down_period" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="warmup_period" label="warmup_period" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="warmup_threshold" label="warmup_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="min_metric_vol" label="min_metric_vol" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="min_metric_deviation" label="min_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="med_metric_deviation" label="med_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="high_metric_deviation" label="high_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_measure" label="causation_measure" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_top_count" label="causation_top_count" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_min_measure" label="causation_min_measure" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_rule_name" label="causation_rule_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="factor" label="factor" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_measure" label="metric_measure" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_baseline" label="metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_id" label="contextual_metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="score" label="score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_deviation" label="metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="low_threshold_rule" label="low_threshold_rule" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="low_threshold_rule_expr" label="low_threshold_rule_expr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="warmup_rule" label="warmup_rule" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="warmup_rule_expr" label="warmup_rule_expr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="active_metric_rule" label="active_metric_rule" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="active_metric_rule_expr" label="active_metric_rule_expr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="active_contextual_metric_rule" label="active_contextual_metric_rule" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="active_contextual_metric_rule_expr" label="active_contextual_metric_rule_expr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="contextual_metric_time_skew" label="contextual_metric_time_skew" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_time_skew_rule" label="contextual_metric_time_skew_rule" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_time_skew_rule_text" label="contextual_metric_time_skew_rule_text" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="config_setting_tm" label="config_setting_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_pattern" label="dim_pattern" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="config_metric_id" label="config_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="service_name" label="service_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="sub_service_name" label="sub_service_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="correlation_time" label="correlation_time" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="groupable" label="groupable" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_history_per" label="metric_history_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="max_low_per" label="max_low_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="max_med_per" label="max_med_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="tot_max_low_per" label="tot_max_low_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="tot_max_med_per" label="tot_max_med_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="max_warmup_per" label="max_warmup_per" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="late_data_timer" label="late_data_timer" type="long" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.incident_in" isClassRef="true">
              <Variables>
                <Variable alias="adj_metric_median" outputType="double" value="if (metric_baseline != 0, metric_baseline,1.0)"/>
                <Variable alias="adj_contextual_metric_baseline" outputType="double" value="if (contextual_metric_baseline != 0, contextual_metric_baseline,1.0)"/>
                <Variable alias="m_deviation" outputType="double" value="if (metric_measure!=0, (metric_measure-metric_baseline)/adj_metric_median,0.0)"/>
                <Variable alias="c_deviation" outputType="double" value="if (contextual_metric_aggr != 0, (contextual_metric_aggr-contextual_metric_baseline)/adj_contextual_metric_baseline, 0.0)"/>
                <Variable alias="active_metric_rule" outputType="boolean" value="(threshold_policy=&quot;above&quot; and metric_measure &gt; min_metric_vol and m_deviation &gt; min_metric_deviation) or ((threshold_policy=&quot;below&quot; and metric_measure &lt; min_metric_vol and m_deviation &lt; min_metric_deviation * -1.0))"/>
                <Variable alias="warmup_rule" outputType="boolean" value="(threshold_policy=&quot;above&quot; and metric_measure &gt; min_metric_vol and m_deviation &gt; threshold_low and warmup_period &gt; anomaly_interval) or (threshold_policy=&quot;below&quot; and metric_measure &lt; min_metric_vol and m_deviation &lt; threshold_low * -1.0 and warmup_period &gt; anomaly_interval)"/>
                <Variable alias="low_threshold_rule" outputType="boolean" value="(threshold_policy=&quot;above&quot; and metric_measure &gt; min_metric_vol and m_deviation &gt; threshold_low and warmup_period &lt;= anomaly_interval) or (threshold_policy=&quot;below&quot; and metric_measure &lt; min_metric_vol and m_deviation &lt; threshold_low * -1.0 and warmup_period &lt;= anomaly_interval)"/>
                <Variable alias="contextual_metric_skew" outputType="long" value="if (contextual_metric_id != &apos;none&apos;, start_tm-contextual_metric_start_tm,0)"/>
              </Variables>
              <Computes>
                <Compute op="sleText" field="*" arg="" value="algorithm" outputType="string" alias="algorithm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_id" outputType="string" alias="metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="dim_keys" outputType="string" alias="dim_keys" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="window" outputType="string" alias="window" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="threshold_policy" outputType="string" alias="threshold_policy" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="start_tm" outputType="long" alias="start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="end_tm" outputType="long" alias="end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="mode" outputType="string" alias="mode" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="emit_notification" outputType="string" alias="emit_notification" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="max_contextual_metric_time_skew" outputType="long" alias="max_contextual_metric_time_skew" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="anomaly_interval" outputType="long" alias="anomaly_interval" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="threshold_high" outputType="double" alias="threshold_high" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="threshold_low" outputType="double" alias="threshold_low" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="threshold_med" outputType="double" alias="threshold_med" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="med_threshold_period" outputType="long" alias="med_threshold_period" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="high_threshold_period" outputType="long" alias="high_threshold_period" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="expire_after" outputType="long" alias="expire_after" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="cool_down_period" outputType="long" alias="cool_down_period" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="warmup_period" outputType="long" alias="warmup_period" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="warmup_threshold" outputType="double" alias="warmup_threshold" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="min_metric_vol" outputType="double" alias="min_metric_vol" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="min_metric_deviation" outputType="double" alias="min_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="med_metric_deviation" outputType="double" alias="med_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="high_metric_deviation" outputType="double" alias="high_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="min_contextual_metric_vol" outputType="integer" alias="min_contextual_metric_vol" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="min_contextual_metric_deviation" outputType="double" alias="min_contextual_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="med_contextual_metric_deviation" outputType="double" alias="med_contextual_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="high_contextual_metric_deviation" outputType="double" alias="high_contextual_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="causation_measure" outputType="string" alias="causation_measure" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="causation_top_count" outputType="long" alias="causation_top_count" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="causation_min_measure" outputType="double" alias="causation_min_measure" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="causation_rule_name" outputType="string" alias="causation_rule_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="causation_suppl_measure" outputType="string" alias="causation_suppl_measure" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="double" alias="factor" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_measure" outputType="double" alias="metric_measure" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_baseline" outputType="double" alias="metric_baseline" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_id" outputType="string" alias="contextual_metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_start_tm" outputType="long" alias="contextual_metric_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_end_tm" outputType="long" alias="contextual_metric_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_aggr" outputType="double" alias="contextual_metric_aggr" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_baseline" outputType="double" alias="contextual_metric_baseline" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_median_baseline" outputType="double" alias="contextual_metric_median_baseline" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="double" alias="score" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="m_deviation" outputType="double" alias="metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="c_deviation" outputType="double" alias="contextual_metric_deviation" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="low_threshold_rule" outputType="boolean" alias="low_threshold_rule" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;(threshold_policy=&apos;above&apos; and metric_measure &gt; min_metric_vol and m_deviation &gt; threshold_low and warmup_period &lt;= anomaly_interval) or (threshold_policy=&apos;below&apos; and metric_measure &lt; min_metric_vol and m_deviation &lt; threshold_low * -1.0 and warmup_period &lt;= anomaly_interval)&quot;" outputType="string" alias="low_threshold_rule_expr" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="warmup_rule" outputType="boolean" alias="warmup_rule" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;(threshold_policy=&apos;above&apos; and metric_measure &gt; min_metric_vol and m_deviation &gt; threshold_low and warmup_period &gt; anomaly_interval) or (threshold_policy=&apos;below&apos; and metric_measure &lt; min_metric_vol and m_deviation &lt; threshold_low * -1.0 and warmup_period &gt; anomaly_interval)&quot;" outputType="string" alias="warmup_rule_expr" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="active_metric_rule" outputType="boolean" alias="active_metric_rule" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;(threshold_policy=&apos;above&apos; and metric_measure &gt; min_metric_vol and m_deviation &gt; min_metric_deviation) or ((threshold_policy=&apos;below&apos; and metric_measure &lt; min_metric_vol and m_deviation &lt; min_metric_deviation * -1.0))&quot;" outputType="string" alias="active_metric_rule_expr" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="boolean" alias="active_contextual_metric_rule" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="string" alias="active_contextual_metric_rule_expr" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="contextual_metric_skew" outputType="long" alias="contextual_metric_time_skew" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="boolean" alias="contextual_metric_time_skew_rule" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="string" alias="contextual_metric_time_skew_rule_text" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_nonoption(unix_timestamp_millisec(upd_dt)/1000)" outputType="long" alias="config_setting_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="config_dim_pattern" outputType="string" alias="dim_pattern" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="config_metric_id" outputType="string" alias="config_metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="service_name" outputType="string" alias="service_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="sub_service_name" outputType="string" alias="sub_service_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="correlation_time" outputType="long" alias="correlation_time" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="groupable" outputType="string" alias="groupable" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="long" alias="metric_history_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="long" alias="max_low_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="long" alias="max_med_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="long" alias="tot_max_low_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="" outputType="long" alias="tot_max_med_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="max_warmup_period" outputType="long" alias="max_warmup_per" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="late_data_timer" outputType="long" alias="late_data_timer" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2002" uuid="43cdd63f-e4f9-459f-81d4-50991c155d24" type="stateMachine" label="Incident Management" x="606" y="33" width="130" height="115">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:viaops.incident_in">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5721106c-efe5-428b-8015-f3a4876ab73e">
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="mode" label="mode" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="emit_notification" label="emit_notification" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="anomaly_interval" label="anomaly_interval" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_high" label="threshold_high" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_low" label="threshold_low" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_med" label="threshold_med" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_threshold_period" label="med_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_threshold_period" label="high_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="expire_after" label="expire_after" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="cool_down_period" label="cool_down_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_period" label="warmup_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_threshold" label="warmup_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_vol" label="min_metric_vol" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_deviation" label="min_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_metric_deviation" label="med_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_metric_deviation" label="high_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_measure" label="causation_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_top_count" label="causation_top_count" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_min_measure" label="causation_min_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_rule_name" label="causation_rule_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="factor" label="factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_measure" label="metric_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_baseline" label="metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_id" label="contextual_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="score" label="score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_deviation" label="metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule" label="low_threshold_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule_expr" label="low_threshold_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="warmup_rule" label="warmup_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_rule_expr" label="warmup_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_metric_rule" label="active_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_metric_rule_expr" label="active_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_contextual_metric_rule" label="active_contextual_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_contextual_metric_rule_expr" label="active_contextual_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="contextual_metric_time_skew" label="contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule" label="contextual_metric_time_skew_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule_text" label="contextual_metric_time_skew_rule_text" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_setting_tm" label="config_setting_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_pattern" label="dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_metric_id" label="config_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="service_name" label="service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sub_service_name" label="sub_service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="correlation_time" label="correlation_time" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="groupable" label="groupable" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_history_per" label="metric_history_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_low_per" label="max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_med_per" label="max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_low_per" label="tot_max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_med_per" label="tot_max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_warmup_per" label="max_warmup_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="late_data_timer" label="late_data_timer" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Source name="source2" uid="1" outputType="DStream" dataType="class:VE">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="17bd52de-6b73-4f7f-8110-1cfb215b2296">
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="event_tm" label="event_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="virtual_event_tm" label="virtual_event_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="ip" uid="0" outputType="DStream" dataType="class:viaops.incident_out" referenceType="viaops.incident_out">
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="event_tm" label="event_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="id" label="id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="state" label="state" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="operation" label="operation" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window" label="window" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score" label="score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="peak_score" label="peak_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="derived_severity" label="derived_severity" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="max_severity" label="max_severity" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_measure" label="metric_measure" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_baseline" label="metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="factor" label="factor" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_deviation" label="metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_id" label="contextual_metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_measure" label="causation_measure" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_top_count" label="causation_top_count" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_min_measure" label="causation_min_measure" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_rule_name" label="causation_rule_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="expire_tm" label="expire_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="active_duration" label="active_duration" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_policy" label="threshold_policy" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_low" label="threshold_low" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_med" label="threshold_med" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="threshold_high" label="threshold_high" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="action" label="action" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="warmup_threshold" label="warmup_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="warmup_duration" label="warmup_duration" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="cooldown_duration" label="cooldown_duration" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="config_metric_id" label="config_metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="dim_pattern" label="dim_pattern" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="service_name" label="service_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="sub_service_name" label="sub_service_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="correlation_end_tm" label="correlation_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="groupable" label="groupable" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="alternate_id" label="alternate_id" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="mode" label="mode" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"isEventTime":"true","source":[{"_deletable":true,"source":"source1","correlation":["metric_id","window","threshold_policy"],"timestamp":"start_tm","drop":true,"_id":"417fa224-c8e6-4b6e-8d53-1cbf3271c6d7"},{"_id":"dd859486-5506-4341-8a1a-40a513c18739","source":"source2","correlation":["metric_id","window","threshold_policy"],"timestamp":"event_tm","drop":true,"_deletable":true}],"states":[{"name":"Start","label":"Start","_id":"Start","type":"Start","x":40,"y":188,"onEntryAction":{"statements":[]},"onStayAction":{"statements":[]},"onExitAction":{"statements":[]},"width":"130","height":80},{"name":"Active","label":"Active","_id":"State","type":"State","x":260,"y":80,"onEntryAction":{"statements":[]},"onStayAction":{"statements":[]},"onExitAction":{"statements":[]},"width":"130","height":80},{"name":"Cooldown","label":"Cooldown","type":"State","x":560,"y":46,"width":"130","height":80,"onEntryAction":{"statements":[]},"onStayAction":{"statements":[]},"onExitAction":{"statements":[]},"_id":"6e195f26-9cd4-473d-8f9a-50655087ec26"},{"name":"End","label":"End","type":"End","x":1047,"y":128,"width":"130","height":80,"onEntryAction":{"statements":[{"id":"035165ef-0b36-490e-86a7-60bcee8f33ab","internalID":"2db476a3-2f7d-4df2-8ff7-a93d7e9851de","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"ctx.endInstance()"}]},{"ref":"EndInstance","desc":"End instance on condition {condition}","bindings":[{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"},"defaultValue":{"text":"true","option":"false","type":"boolean"}}]}]},"onStayAction":{"statements":[]},"onExitAction":{"statements":[]},"_id":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f"},{"name":"Warmup","label":"Warmup","type":"State","x":400,"y":370,"width":"130","height":80,"onEntryAction":{"statements":[]},"onStayAction":{"statements":[]},"onExitAction":{"statements":[]},"_id":"caa9b573-922a-4e9a-80aa-eda1538e7bf1"}],"transitions":[{"srcId":"State","tgtId":"State","label":"Continue Active","event":"","condition":{"text":"source1.active_metric_rule","type":"boolean","option":true},"action":{"statements":[{"id":"3bdd0ea4-71ac-4445-8fb1-9fce6bd11e5a","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Update\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ee3a2bdb-9f3e-442b-8149-4240ed386c46","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"cf6d24e6-7a7c-4ab0-80fb-066b933d3ed3","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4fcc74b8-c15a-403b-8e88-6c00ab3681c9","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6302df6c-164a-492b-844e-07228abb8af1","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1544add6-8892-4f42-87a9-c6f4ee090374","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a4adcf7e-9d76-49af-8947-3f21e052b1a8","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3ea84aef-2151-4dff-85dc-2f74b4bad260","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3672584e-f262-4ee1-8a61-3ddc3d7f89ca","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5e7cf492-71f2-4c25-8dfc-b604492fd02a","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"53f4666e-5918-4e87-81a0-c9b65b78dda7","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f872eae5-f6e5-40ab-8c8a-9ac42773657a","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"bd78e1ed-25b7-437f-8213-12d52b222ff9","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e97dd260-135b-43a2-80bc-2515fafd9332","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d85982a4-c87d-49d5-847a-c0a8a3f5765f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"fb0c6c71-d4f0-4893-810e-533d64ba0e02","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"64d2ffca-ec96-4a97-8c1c-63886e5e4d9d","internalID":"5a388a11-75ec-43b4-86b6-b6923142dc44","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\r\n    import com.vitria.spark.api.scala.OperatorUtils._\r\n    val anomaly = event.source1.get\r\n    val metric_dev = anomaly.metric_deviation\r\n    val low_t = anomaly.threshold_low\r\n    val med_t = anomaly.threshold_med\r\n    val high_t = anomaly.threshold_high\r\n    val interval = anomaly.anomaly_interval\r\n    val med_t_p = ctx.getGlobalVar[Long](\"med_threshold_per\")\r\n    val high_t_p = ctx.getGlobalVar[Long](\"high_threshold_per\")\r\n    val threshold_policy = anomaly.threshold_policy\r\n    val LOW = \"Low\"\r\n    val MED = \"Medium\"\r\n    val HIGH = \"High\"\r\n    val ABOVE = \"above\"\r\n    val BELOW = \"below\"\r\n    var max_esc_severity = ctx.getGlobalVar[String](\"max_esc_severity\").getOrElse(\"\")\r\n    var max_severity = ctx.getGlobalVar[String](\"max_severity\").getOrElse(\"\")\r\n    var active_per = ctx.getGlobalVar[Long](\"active_per\") \r\n    \r\n    def _GE(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GE v2\r\n      case BELOW =&gt; v1 LE (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    def _GT(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GT v2\r\n      case BELOW =&gt; v1 LT (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n    \r\n    val severity = if (_GT(metric_dev, high_t, threshold_policy)) HIGH\r\n    else if (_GT(metric_dev, med_t, threshold_policy)) MED\r\n    else if (_GT(metric_dev, low_t, threshold_policy)) LOW\r\n    else \"\"\r\n      \r\n    val derived_severity =\r\n      if (_GT(metric_dev, low_t, threshold_policy)) {\r\n        active_per = active_per ADD Option(interval)\r\n        if ((active_per GT high_t_p).getOrElse(false)) {\r\n          max_esc_severity = HIGH\r\n          HIGH\r\n        } else if ((active_per GT med_t_p).getOrElse(false)) {\r\n          max_esc_severity = MED\r\n          MED\r\n        } else\r\n          severity\r\n      } else if (max_esc_severity.length() &gt; 0) //previously escalated\r\n        max_esc_severity\r\n      else //never escalated and kept Active due to deviation/warmup exceeded\r\n        LOW //artificial Low\r\n\r\n    def compare(s1: String, s2: String): String = {\r\n      def conv(s: String) = s match {\r\n        case HIGH   =&gt; 3\r\n        case MED =&gt; 2\r\n        case LOW    =&gt; 1\r\n        case _        =&gt; 0\r\n      }\r\n      if (conv(s1) &gt; conv(s2)) s1 else s2\r\n    }\r\n\r\n    max_severity = compare(compare(severity, derived_severity), max_severity)\r\n    \r\n    ctx.setGlobalVar(\"severity\", severity)\r\n    ctx.setGlobalVar(\"derived_severity\", derived_severity)\r\n    ctx.setGlobalVar(\"max_esc_severity\", max_esc_severity)\r\n    ctx.setGlobalVar(\"max_severity\", max_severity)\r\n    ctx.setGlobalVar(\"active_per\", active_per)"}]},{"id":"9ceab671-51ae-4ea9-88e5-b5cdfb4632e8","internalID":"9588d515-0a9b-4227-8908-e4af1b991bb0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"active_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"severity!=\"\"","type":"boolean","option":true}}]},{"id":"6c48d680-74ae-4eae-8a97-c2f36d8fb2aa","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_active_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5001ef4e-8bc5-4dcd-8331-0291ce83a745","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"60493a96-6c96-4299-85cc-62d2045cc41a","internalID":"281e3293-2323-4a1e-8b6d-4080dca40b69","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"    // for logging\r\n    val source1 = event.source1.get\r\n    val LOW  = \"Low\"\r\n    val MED  = \"Medium\"\r\n    val HIGH = \"High\"\r\n    val severity      = ctx.getGlobalVar[String](\"severity\").getOrElse(\"\")\r\n    val last_severity = ctx.getGlobalVar[String](\"last_severity\").getOrElse(\"\")\r\n    var max_esc_severity      = ctx.getGlobalVar[String](\"max_esc_severity\").getOrElse(\"\")\r\n    var last_max_esc_severity = ctx.getGlobalVar[String](\"last_max_esc_severity\").getOrElse(\"\")\r\n    val low_threshold  = source1.threshold_low\r\n    val med_threshold  = source1.threshold_med\r\n    val high_threshold = source1.threshold_high\r\n    val active_periods   = ctx.getGlobalVar[Long](\"active_per\").getOrElse(0L)\r\n    val max_high_periods = ctx.getGlobalVar[Long](\"high_threshold_per\").getOrElse(Long.MaxValue)\r\n    val max_med_periods  = ctx.getGlobalVar[Long](\"med_threshold_per\").getOrElse(Long.MaxValue)\r\n\r\n    val med_escalation_rule  = active_periods &gt; max_med_periods\r\n    val high_escalation_rule = active_periods &gt; max_high_periods\r\n    val all_escalation_cond  = med_escalation_rule|| high_escalation_rule\r\n    val composite_all_escalation_cond = \"\".equals(max_esc_severity) &amp;&amp; ! all_escalation_cond\r\n    val warmup_or_low_rule = source1.`warmup_rule`.getOrElse(false) || source1.`low_threshold_rule`.getOrElse(false)\r\n    var msg = \"\"\r\n    var action = IncidentActionMsg.STAY\r\n    var params:Seq[(String, Any)] = Seq()\r\n    if(composite_all_escalation_cond &amp;&amp; LOW.equals(last_severity) &amp;&amp; LOW.equals(severity)){\r\n      //    BEGIN_STAY_LOW_REASON     STAY\r\n      msg = SimpleDevMsg.BEGIN_STAY_LOW_REASON\r\n      params=Seq((MsgVars.var_med_threshold, med_threshold), (MsgVars.var_low_threshold, low_threshold))\r\n    }else  if(composite_all_escalation_cond &amp;&amp; MED.equals(last_severity) &amp;&amp; MED.equals(severity)){\r\n      //   BEGIN_STAY_MED_REASON    STAY\r\n      msg = SimpleDevMsg.BEGIN_STAY_MED_REASON\r\n      params=Seq((MsgVars.var_med_threshold, med_threshold), (MsgVars.var_high_threshold, high_threshold))\r\n    }else  if(composite_all_escalation_cond &amp;&amp; HIGH.equals(last_severity) &amp;&amp; HIGH.equals(severity)) {\r\n      //    BEGIN_STAY_HIGH_REASON    STAY\r\n      msg = SimpleDevMsg.BEGIN_STAY_HIGH_REASON\r\n      params=Seq( (MsgVars.var_high_threshold, high_threshold))\r\n    }else if(composite_all_escalation_cond &amp;&amp; LOW.equals(last_severity) &amp;&amp; MED.equals(severity)){\r\n      //    UPGRADE_TO_MED_REASON    UPGRADE\r\n      action = IncidentActionMsg.UPGRADE\r\n      msg = SimpleDevMsg.UPGRADE_TO_MED_REASON\r\n      params=Seq((MsgVars.var_med_threshold, med_threshold), (MsgVars.var_high_threshold, high_threshold))\r\n    }else if(composite_all_escalation_cond &amp;&amp; !HIGH.equals(last_severity) &amp;&amp; HIGH.equals(severity)) {\r\n      //    UPGRADE_TO_HIGH_REASON    UPGRADE\r\n      action = IncidentActionMsg.UPGRADE\r\n      msg = SimpleDevMsg.UPGRADE_TO_HIGH_REASON\r\n      params=Seq((MsgVars.var_high_threshold, high_threshold))\r\n    }else if(composite_all_escalation_cond &amp;&amp; !LOW.equals(last_severity) &amp;&amp; LOW.equals(severity)) {\r\n      //    DOWNGRADE_LOW_REASON    DOWNGRADE\r\n      action = IncidentActionMsg.DOWNGRADE\r\n      msg = SimpleDevMsg.DOWNGRADE_LOW_REASON\r\n      params=Seq((MsgVars.var_med_threshold, med_threshold), (MsgVars.var_low_threshold, low_threshold))\r\n    }else if(composite_all_escalation_cond &amp;&amp; HIGH.equals(last_severity) &amp;&amp; MED.equals(severity)) {\r\n      //    DOWNGRADE_MED_REASON    DOWNGRADE\r\n      action = IncidentActionMsg.DOWNGRADE\r\n      msg = SimpleDevMsg.DOWNGRADE_MED_REASON\r\n      params=Seq((MsgVars.var_med_threshold, med_threshold), (MsgVars.var_high_threshold, high_threshold))\r\n    }else if(\"\".equals(last_max_esc_severity) &amp;&amp;  med_escalation_rule &amp;&amp; !high_escalation_rule &amp;&amp; warmup_or_low_rule ){\r\n      //    ESCALATE_TO_MED_REASON_TIME    ESCALATE\r\n      action = IncidentActionMsg.ESCALATE\r\n      msg = SimpleDevMsg.ESCALATE_TO_MED_REASON_TIME\r\n      params=Seq((MsgVars.var_max_med_time, max_med_periods))\r\n    }else if(!HIGH.equals(last_max_esc_severity) &amp;&amp; high_escalation_rule &amp;&amp; warmup_or_low_rule ) {\r\n      //   ESCALATE_TO_HIGH_REASON_TIME    ESCALATE\r\n      action = IncidentActionMsg.ESCALATE\r\n      msg = SimpleDevMsg.ESCALATE_TO_HIGH_REASON_TIME\r\n      params=Seq((MsgVars.var_max_high_time, max_high_periods))\r\n\r\n    }else if( MED.equals(max_esc_severity) &amp;&amp; !(warmup_or_low_rule &amp;&amp; high_escalation_rule) ) {\r\n      //    STAY_RESUME_ESCALATE_MED    STAY\r\n      msg = SimpleDevMsg.STAY_RESUME_ESCALATE_MED\r\n    }else if( HIGH.equals(max_esc_severity)) {\r\n       //    STAY_RESUME_ESCALATE_HIGH    STAY\r\n      msg = SimpleDevMsg.STAY_RESUME_ESCALATE_HIGH\r\n    }else if( \"\".equals(max_esc_severity) &amp;&amp; !warmup_or_low_rule) {\r\n      //   ARTIFICIAL_LOW_REASON    STAY\r\n      msg = SimpleDevMsg.ARTIFICIAL_LOW_REASON\r\n      params=Seq((MsgVars.var_low_threshold, max_high_periods),(MsgVars.var_min_metric_deviation, source1.min_metric_deviation))\r\n    }\r\n    val reason = IncidentMsgUtils.replaceVars(msg, params: _*)\r\n    ctx.setGlobalVar(\"reason\", reason)\r\n    ctx.setGlobalVar(\"action\", action)\r\n"}]},{"id":"1ba6a22e-78fe-4754-82f3-da29263afeb5","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"de17aef3-fb63-4039-81fe-52894652d7b9","internalID":"810c574d-810f-4e8c-83c9-b467943b344d","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"derived_severity","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"eb69a6b2-bf4e-493e-818f-40cb518079be","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ffbbae8c-af45-4b3b-822a-eb254d7fd440","internalID":"27fd1151-c7f3-4f5a-8a11-c41494d0c172","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_max_esc_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"max_esc_severity","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Active","toState":"Active","_id":"con_20","labelLoc":0.45},{"srcId":"State","tgtId":"6e195f26-9cd4-473d-8f9a-50655087ec26","label":"Begin Cooldown","event":"","condition":{"text":"!source1.active_metric_rule and cooldown_per&gt;= source1.anomaly_interval","type":"boolean","option":true},"action":{"statements":[{"id":"f173571f-5ca1-4a57-898d-1a181ffdb8b7","internalID":"3c60c2f1-449a-4e04-8f26-946637f8a94c","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"state"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Cooldown\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"0a5dbb4b-3c49-4430-846c-cb2c607f7ca1","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Update\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a5c084a0-c8ad-4802-8a09-4e6e0e958338","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a93a29fb-0ce5-4156-8a87-76be50f23f4d","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3ec2d329-b846-41ac-8b5c-5aea96b33709","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6fce6f82-de97-40fd-8460-54aa60f45ab4","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"802c67e0-1111-4ccc-8cef-d51b646754d3","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ede0cf2a-74f5-4ffa-89d3-9001ded83467","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"dc11b536-f4c8-49ec-89cb-7c42800a92fa","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"092b2b01-f4b7-4afb-8f32-8cc50abe00c2","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ee4616f7-6c3e-4911-8d11-56fe033e2924","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"936e80da-1ffe-431f-8405-5791b8f36bc6","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5a862f4c-e9a4-4617-8cfb-44df84df5363","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d4c48d19-3300-4ac6-88a7-653e63ad3650","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d00c2996-eca5-40be-8190-e95a54c63453","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"2ebba9d7-2353-4cb2-8c30-449c3a6d5960","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"2670e34b-8847-4bc2-8d67-d3265ef1f1d7","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b8ff2fab-e007-4bc0-8ed6-5762b2a90d33","internalID":"28cc64f9-cbbc-4190-8178-b7bb8e8bcfc4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"feac7bc3-9cc0-45e7-8d92-942ee285f925","internalID":"28cc64f9-cbbc-4190-8178-b7bb8e8bcfc4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"derived_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Cooldown\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"9b0a67c2-3ae0-4cb2-8088-1c442f2628f8","internalID":"512008d7-a3fc-43c2-8dd3-33e8db7840bd","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cooldown_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.anomaly_interval","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a5c29f8e-0fd5-4eb3-846a-5faf2b63ffd6","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"f247ea35-db80-4fdd-8015-a1b3c4e2dbde","internalID":"06ab8264-453b-4d0e-8d26-781d583a3ea0","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\r\nval msg = SimpleDevMsg.BEGIN_STAY_COOLDOWN_REASON\r\nval reason = IncidentMsgUtils.replaceVars(msg, (MsgVars.var_min_metric_deviation, source1.min_metric_deviation),\r\n                                               (MsgVars.var_min_metric_val, source1.min_metric_vol))\r\nctx.setGlobalVar(\"reason\", reason)\r\nval action = IncidentActionMsg.BEGIN\r\nctx.setGlobalVar(\"action\", action)\r\n"}]},{"id":"9eac4377-a096-4a55-88e7-a73e72e82ecf","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"cooldown_dur","type":"long","option":true},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"43ebc545-c8f5-4e24-8f1f-b0c8fd211db5","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Active","toState":"Cooldown","_id":"con_24","labelLoc":0.5103448275862069},{"srcId":"State","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Close Incident (Active)","event":"","condition":{"text":"!source1.active_metric_rule and cooldown_per&lt; source1.anomaly_interval","type":"boolean","option":true},"action":{"statements":[{"id":"979c0e29-70e0-4a7d-88a6-085f5c5bd7c8","internalID":"0ae4dbef-e75b-48dd-820e-f24f5d563d93","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1df30ef0-385e-41aa-8286-a8ae06a40a98","internalID":"e78fa327-d98f-4471-857b-769659aa79ea","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f43366c1-3d47-432a-8253-bf96f88fa18f","internalID":"79606b96-500f-43ea-8ac4-6d37504e82b2","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Close\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"53633953-2e87-4d0a-8ee3-132697769cae","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"876ffa53-ac6e-4963-8d73-63cc9d6d11f8","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"9139b182-8246-4d1c-824f-6a024df381bb","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3c7b98c7-c3a9-4d64-85d0-b33452e4a3e9","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"39675c1c-1aab-46e2-8e74-e7dbb2616ecd","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b7891f97-c90e-4d99-810a-63bfaca29589","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b3a0917c-aaf0-416b-839d-1875b41a487a","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"423c3bab-afd1-4eb3-8932-b749964358e1","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"841700b6-5eac-4499-80ec-69f4c6507b70","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"130c3deb-bb0c-42dc-8a22-59e487db22cd","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"55f6b710-caea-4631-819d-991dda9bb803","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"fd06746c-4b78-4cd9-8b16-7f9a8f64717e","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5368034e-757a-4952-8127-36ce9e44e154","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d6f08c13-78c4-4260-8e32-f18097827502","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c3aecc74-f161-474a-85fa-9dcedcfd4ff0","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5eb63ce0-4ddf-492f-89c6-f2751ce11ef1","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"c07adee4-10f7-4a4e-8e32-561d130bf1bb","internalID":"b59910f1-dba0-40fa-815a-407e069b0318","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.BEGIN_STAY_COOLDOWN_REASON, \n             (MsgVars.var_min_metric_deviation, source1.min_metric_deviation), (MsgVars.var_min_metric_val, source1.min_metric_vol))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", IncidentActionMsg.INCIDENT_END + IncidentActionMsg.COMPLETE)"}]},{"id":"c76ff45a-d18d-4ef0-89b6-8c7e02fb49f5","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"last_active_end_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"cooldown_dur","type":"long","option":true},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"8806af1d-cc9f-4827-88c9-8d589ba43d7f","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Active","toState":"End","_id":"con_88","labelLoc":0.528158295281583},{"srcId":"State","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Expire (Active)","event":"","condition":{"text":" source2.virtual_event_tm &gt; expire_event_tm ","type":"boolean","option":true},"action":{"statements":[{"id":"597f9637-e245-4d84-83f8-6fb127db9f4c","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Expire\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6483cc41-4442-460e-8c11-a959be0e9eec","internalID":"bbc454bb-9bb7-4a47-89ed-a3137cdb909d","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\nval action = IncidentActionMsg.INCIDENT_END +  IncidentActionMsg.ABORT\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.EXPIRED_REASON, (MsgVars.var_expired_tm_duration, ctx.getGlobalVar[Long](\"expire_tm_duration\")))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"5cf43edd-3915-45b7-80e0-56aa193a5c21","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"expire_event_tm","type":"long","option":true},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"expire_event_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_event_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"config_metric_id":{"text":"config_metric_id\n","type":"string","option":true},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]}]},"priority":0,"fromState":"Active","toState":"End","_id":"con_82"},{"srcId":"6e195f26-9cd4-473d-8f9a-50655087ec26","tgtId":"State","label":"Resume Active","event":"","condition":{"text":"source1.active_metric_rule","type":"boolean","option":true},"action":{"statements":[{"id":"268a855c-198d-4a1b-8f1f-344ed7fbfddc","internalID":"fd5e58c3-370f-4369-8a85-08596e083bea","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"state"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Active\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"77c7f1c8-c008-4fa8-8ff6-91f009189b0d","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"50eeee2c-099d-42a0-84ab-f77b15ce3ff1","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4fd1737d-5a15-4400-87d9-d5a4d4145493","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e9bca2cf-1f39-4ae2-85a6-b026a82e40a5","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f6ee3734-7814-4f99-85c9-db3693e23ffc","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"42446788-f238-4c47-83cd-21879affce36","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f0bf1033-d990-4767-8fa9-190db1f0678f","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f9ca05cf-161c-48bc-8790-ba7087dde48c","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"261282ec-5a50-47f7-8163-a1ba7a409b02","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3731d3d8-b8fc-4beb-8ef7-5d02cb875afb","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"522d872e-49c5-41a0-8415-ddbfc620a697","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3035dd7b-af17-412b-8a1a-6dca328045cf","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"64d4e858-caa3-4539-88aa-254d292d95d6","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d8794df3-cf58-4e7c-8642-41a24a973c87","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"74b95082-f0e1-4db0-8f8b-0b57aa2956ea","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"30abc76e-b15f-4072-84e3-4f8a1be3e5dc","internalID":"5a388a11-75ec-43b4-86b6-b6923142dc44","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\r\n    import com.vitria.spark.api.scala.OperatorUtils._\r\n    val anomaly = event.source1.get\r\n    val metric_dev = anomaly.metric_deviation\r\n    val low_t = anomaly.threshold_low\r\n    val med_t = anomaly.threshold_med\r\n    val high_t = anomaly.threshold_high\r\n    val interval = anomaly.anomaly_interval\r\n    val med_t_p = ctx.getGlobalVar[Long](\"med_threshold_per\")\r\n    val high_t_p = ctx.getGlobalVar[Long](\"high_threshold_per\")\r\n    val threshold_policy = anomaly.threshold_policy\r\n    val LOW = \"Low\"\r\n    val MED = \"Medium\"\r\n    val HIGH = \"High\"\r\n    val ABOVE = \"above\"\r\n    val BELOW = \"below\"\r\n    var max_esc_severity = ctx.getGlobalVar[String](\"max_esc_severity\").getOrElse(\"\")\r\n    var max_severity = ctx.getGlobalVar[String](\"max_severity\").getOrElse(\"\")\r\n    var active_per = ctx.getGlobalVar[Long](\"active_per\") \r\n    \r\n    def _GE(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GE v2\r\n      case BELOW =&gt; v1 LE (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    def _GT(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GT v2\r\n      case BELOW =&gt; v1 LT (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n    \r\n    val severity = if (_GT(metric_dev, high_t, threshold_policy)) HIGH\r\n    else if (_GT(metric_dev, med_t, threshold_policy)) MED\r\n    else if (_GT(metric_dev, low_t, threshold_policy)) LOW\r\n    else \"\"\r\n      \r\n    val derived_severity =\r\n      if (_GT(metric_dev, low_t, threshold_policy)) {\r\n        active_per = active_per ADD Option(interval)\r\n        if ((active_per GT high_t_p).getOrElse(false)) {\r\n          max_esc_severity = HIGH\r\n          HIGH\r\n        } else if ((active_per GT med_t_p).getOrElse(false)) {\r\n          max_esc_severity = MED\r\n          MED\r\n        } else\r\n          severity\r\n      } else if (max_esc_severity.length() &gt; 0) //previously escalated\r\n        max_esc_severity\r\n      else //never escalated and kept Active due to deviation/warmup exceeded\r\n        LOW //artificial Low\r\n\r\n    def compare(s1: String, s2: String): String = {\r\n      def conv(s: String) = s match {\r\n        case HIGH   =&gt; 3\r\n        case MED =&gt; 2\r\n        case LOW    =&gt; 1\r\n        case _        =&gt; 0\r\n      }\r\n      if (conv(s1) &gt; conv(s2)) s1 else s2\r\n    }\r\n\r\n    max_severity = compare(compare(severity, derived_severity), max_severity)\r\n    \r\n    ctx.setGlobalVar(\"severity\", severity)\r\n    ctx.setGlobalVar(\"derived_severity\", derived_severity)\r\n    ctx.setGlobalVar(\"max_esc_severity\", max_esc_severity)\r\n    ctx.setGlobalVar(\"max_severity\", max_severity)\r\n    ctx.setGlobalVar(\"active_per\", active_per)"}]},{"id":"8d149c10-d8c4-4d34-81fb-76686d8769a9","internalID":"9588d515-0a9b-4227-8908-e4af1b991bb0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"active_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","type":"boolean","option":false}}]},{"id":"4c553e1c-6fd3-4276-846a-c67a41d8f7c3","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_active_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"78468a24-5066-44f7-835a-edb7ef345588","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"b0d5051c-2678-4736-8f7b-251359db86c1","internalID":"e7fac142-6ba2-43ab-8c9e-73a18d2a7974","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\r\n\r\nvar max_esc_severity = ctx.getGlobalVar[String](\"max_esc_severity\").getOrElse(\"\")\r\nvar msg = SimpleDevMsg.ABORT_COOLDOWN_REASON\r\nval warmup_or_low_rule = source1.`warmup_rule`.get || source1.`low_threshold_rule`.get\r\nif(\"\".equals(max_esc_severity) &amp;&amp; !warmup_or_low_rule){\r\n  msg = SimpleDevMsg.ARTIFICIAL_LOW_REASON\r\n}\r\nval params=Seq((MsgVars.var_low_threshold, source1.`threshold_low`),(MsgVars.var_min_metric_deviation, source1.min_metric_deviation),\r\n  (MsgVars.var_min_metric_val,source1.`min_metric_vol` ))\r\n  \r\nval reason = IncidentMsgUtils.replaceVars(msg, params:_*)\r\nctx.setGlobalVar(\"reason\", reason)\r\nval action = IncidentActionMsg.ABORT_AND_RESUME\r\nctx.setGlobalVar(\"action\", action)\r\nctx.setGlobalVar(\"last_max_esc_severity\", max_esc_severity)\r\n "}]},{"id":"5ab47720-8c3f-4738-82e1-baba95445b49","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"e65949fd-65cd-4d82-8a0b-b7d387f63b10","internalID":"ba968eae-4a27-40ee-8003-cbe15ba54623","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"derived_severity","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ebad6fd0-983b-46fe-85e8-d40ce2e3e41e","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Cooldown","toState":"Active","_id":"con_36","labelLoc":0.43448275862068964},{"srcId":"6e195f26-9cd4-473d-8f9a-50655087ec26","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Close Incident (Cooldown)","event":"","condition":{"text":"!source1.active_metric_rule and cooldown_dur + source1.anomaly_interval &gt;= cooldown_per","type":"boolean","option":true},"action":{"statements":[{"id":"a85847ca-5ceb-4c56-8d38-bb2f81343342","internalID":"0ae4dbef-e75b-48dd-820e-f24f5d563d93","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"690a981c-2e96-404e-81a1-7fac800ade7e","internalID":"93158105-66d8-44eb-8d63-cbf150fe8476","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"85edfbf4-202d-4e86-80bb-bf39bd449e7e","internalID":"79606b96-500f-43ea-8ac4-6d37504e82b2","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Close\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"870ee26a-ac6f-4b25-8314-05104c49d286","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ca36f24a-d023-44ac-8eae-d66923526fbb","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"2d4c1441-4833-488c-8704-c244f536cdf4","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"845d0216-3bd8-41e9-8f5b-c0a19f959c96","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"29338ff1-ac17-42fd-8733-ab24cc2882ee","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"448adb3f-24ef-4b58-8090-17a15ac24f9d","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b1e90ab7-1587-4bfd-841c-a11cdb505a4e","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e73bd750-11f4-425b-8482-ece410f6730b","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a4b2ba61-d0ee-44c9-82e7-068d6833a514","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"65d1147e-a683-4956-8520-8bcc1bd80b30","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"10b0c05c-3118-4674-8f38-3b5dc0dc36fd","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"eb72cd49-1a54-4263-8ce2-8f3bdbcb155a","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"8c298876-014c-42ad-8613-7db62257a6ea","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a8964bb9-5745-4fbb-85fd-a0d44d20031f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d7a0e7e6-87f5-45f9-8ac0-7375a4b35b93","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5c3782a4-0fcd-4361-8f14-daf6fb3a9be0","internalID":"0971e59e-fecf-481e-8388-67ec522be4ab","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cooldown_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"cooldown_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"25185671-f28a-476d-8489-6aafbed96913","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"07da4c2b-b0c6-401a-8b8a-35597b1cc1a0","internalID":"6d07341b-5ca3-4295-8458-964ba8d47fc0","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":" val source1 = event.source1.get\r\n val msg = SimpleDevMsg.COMPLETE_COOLDOWN_REASON\r\n val reason = IncidentMsgUtils.replaceVars(msg, (MsgVars.var_max_cooldown_time, ctx.getGlobalVar[Long](\"cooldown_per\")))\r\n ctx.setGlobalVar(\"reason\", reason)\r\n val action =  IncidentActionMsg.INCIDENT_END + IncidentActionMsg.COMPLETE\r\n ctx.setGlobalVar(\"action\", action)"}]},{"id":"f46f8bb2-3b73-4158-8d15-5e3a1fc70740","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"last_active_end_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"cooldown_dur","type":"long","option":true},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]}]},"priority":0,"fromState":"Cooldown","toState":"End","_id":"con_46","labelLoc":0.46835443037974683},{"srcId":"6e195f26-9cd4-473d-8f9a-50655087ec26","tgtId":"6e195f26-9cd4-473d-8f9a-50655087ec26","label":"Continue Cooldown","event":"","condition":{"text":"!source1.active_metric_rule and cooldown_dur + source1.anomaly_interval &lt; cooldown_per","type":"boolean","option":true},"action":{"statements":[{"id":"5d589799-1766-4057-8512-351ed5731a0e","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4a42c0b4-f8c2-40cf-861e-b629a94cbdef","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"eb4f41c8-b5c3-4bef-894f-d26f72c46b5c","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"aa675e53-19e4-47f0-8216-1fa3a3d217b0","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"feb9d672-4f0b-41e1-8812-72b36a96799b","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"7257fde1-6f83-48ee-8301-9a3d40075259","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e3ade941-cbb9-4cd0-89bb-46c3c6ee2289","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"0b0c8d08-55f7-4330-83ad-ebba12ee4f89","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"81e5c621-1c96-4d1f-887a-8baa32d68acc","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4a7b8a61-b117-4793-8b12-c3808713761a","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"0a9fef6d-c63b-40c4-8f47-099957ef351d","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"04033499-1dbe-4e9c-8a75-10a77af4745a","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"af8d3d3e-9858-489a-8930-9bbd70466c02","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f10e82d0-efc7-42dd-819d-b0fe4d56a586","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4f9bb0b4-39e0-46cc-8e36-c0b0d6511583","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d6aacf01-7459-4cdc-8e39-2bee32de51b2","internalID":"0971e59e-fecf-481e-8388-67ec522be4ab","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cooldown_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"cooldown_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f9147e0f-32fb-4279-8f0f-2e644ef64c72","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"6f6ecc08-3d9f-4a2f-8205-89a10f3ea361","internalID":"b6a1b677-3f2a-470d-87fe-0b9c91340bd3","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\r\nval msg = SimpleDevMsg.BEGIN_STAY_COOLDOWN_REASON\r\nval reason = IncidentMsgUtils.replaceVars(msg, (MsgVars.var_min_metric_deviation, source1.min_metric_deviation),\r\n                                            (MsgVars.var_min_metric_val, source1.`min_metric_vol`))\r\nctx.setGlobalVar(\"reason\", reason)\r\nval action = IncidentActionMsg.CONTINUE\r\nctx.setGlobalVar(\"action\", action)"}]},{"id":"d46e2084-5ca1-420f-8583-a8a173b1e3b2","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"cooldown_dur","type":"long","option":true},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"7e7a5d0f-82bc-43d8-8103-91dbdf749899","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Cooldown","toState":"Cooldown","_id":"con_63","labelLoc":0.45},{"srcId":"6e195f26-9cd4-473d-8f9a-50655087ec26","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Expire (Cooldown)","event":"","condition":{"text":" source2.virtual_event_tm &gt; expire_event_tm ","type":"boolean","option":true},"action":{"statements":[{"id":"ad9f5930-39e9-46b7-8b4e-f6fef71c664b","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Expire\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"0a6be62c-cff9-4265-862e-142783388135","internalID":"bbc454bb-9bb7-4a47-89ed-a3137cdb909d","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\nval action = IncidentActionMsg.CONTINUE\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.EXPIRED_REASON, (MsgVars.var_expired_tm_duration, ctx.getGlobalVar[Long](\"expire_tm_duration\")))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"22a688ef-794e-43b1-84f1-f01e3d5cbe21","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"expire_event_tm","type":"long","option":true},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"expire_event_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_event_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"config_metric_id":{"text":"config_metric_id\n","type":"string","option":true},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]}]},"priority":0,"fromState":"Cooldown","toState":"End","_id":"con_72"},{"_id":"tran_1","label":"New Incident","fromState":"Start","toState":"Active","event":"","condition":{"text":"source1.low_threshold_rule","type":"boolean","option":true},"action":{"statements":[{"id":"cf7f591c-930d-4d64-830e-444122a5dbe6","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Create\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3095308e-4ad3-4bc6-8192-f4859a1518ca","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"state"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Active\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"bc405565-b0c2-4114-8e1b-6c88a4b40a62","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"start_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"876a7316-565b-49d4-84d8-dde95a76b631","internalID":"ce7da8cf-c1e0-4044-8a88-e8196c07aa8a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"date_key"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.date_key","type":"integer","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3040bb5d-df96-44f5-8232-e1ace529f724","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b1915519-c17a-4cb0-84df-13cfe94e2407","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"algorithm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.algorithm","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4271fb8e-5aca-43ce-8f18-8981da39d4fc","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_policy"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_policy","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"7c1bdea1-4cb3-4eec-827e-2bde1f505c6b","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"130b6ad1-62e1-4d25-8546-ce36c08cc556","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3ff87a2a-d71a-417d-8140-8eb4e58e9afb","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f49cbb3e-a5b7-4119-8007-3436bd3d4d9c","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"854ca239-0aca-4376-8046-d265e5d30c40","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"81e9dd69-7d27-4051-8d60-7bcd96f06a3f","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"42992512-8ba6-4622-8f0b-8c55324fd22a","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6f99b76d-4491-4f2e-8ab7-e5c890341be8","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"11dd0513-ac32-4764-8a02-d8b8bae10a88","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"040a9691-3263-4bb5-8891-d14e4bb47e60","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"464a0f16-160c-4f5d-8d76-254d685be021","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"78faa4c0-ab9e-4292-8285-a0453da413e2","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"772eab61-8260-4595-8e6f-ff6666efc867","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"edb5c6b0-66e2-4eb5-8ec0-52650bf907a1","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"251d1588-07ca-4d30-8e2a-333c80157c08","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ce6a1115-d2dd-47fa-87bb-91b68b82353d","internalID":"99c2c9ab-30c6-4a45-88a0-3ac3c5d2b87b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm - source1.start_tm","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4f7f0ca0-06ab-4e41-85ec-52087ed8fdfc","internalID":"180a0c6f-6e79-4b4c-8bea-2de5a7c7f5a5","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"config_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.config_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e202d297-9dcd-4b74-8088-e714b95e5351","internalID":"4e0a264c-7092-49e2-8901-5c35e2371553","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"dim_keys"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.dim_keys","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c6afec9f-e7df-4b35-8ddf-f62b0a591e8c","internalID":"4e0a264c-7092-49e2-8901-5c35e2371553","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"dim_pattern"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.dim_pattern","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"cace5ad1-3cd1-496b-8a5a-9d22f8471ff0","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_active_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b4d041c6-1c93-4060-8ce9-c92361c788bd","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6fa3915a-9a22-416d-86ac-16887a167a01","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"sub_service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.sub_service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"763912e0-2f63-41d6-8a75-6440e7028fb8","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_time"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.correlation_time","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6f99b650-11ef-4bab-8c70-e8339b301b6f","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"groupable"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.groupable","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","type":"boolean","option":false}}]},{"id":"462037d8-4c5b-4372-818e-56237c2fe0ff","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"213a376d-c871-41e9-859e-a18ba263593f","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"mode"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.mode","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","type":"boolean","option":false}}]},{"id":"53cf66e8-d5a7-415f-8f99-e05342232270","internalID":"2a6c118f-5cfb-4a69-896f-8fbf19ac21d8","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"max_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.max_warmup_per","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a8cb4548-8571-498a-83ed-d0fcc668aa21","internalID":"8fdafc34-0581-4298-8df0-0faf1d2c628a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cooldown_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.cool_down_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"8401e69a-f9ea-4cca-86f7-12d62f760780","internalID":"14e6465a-5c05-40cf-8d94-e72ab5a9f468","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.warmup_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b7afce24-7e11-4826-8272-95d745f55233","internalID":"ee960512-a529-481c-81ad-0a74aba9dcfe","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_qualified_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.anomaly_interval","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"da90ac38-0cae-431c-8837-737c580cb679","internalID":"8feb4b7f-c304-4829-8b4a-f8cffa3e6a24","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"0","type":"int","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1e0d0942-c2e7-413f-8f5c-f9a7a8ef14ca","internalID":"e9aa2e9c-475d-460c-8b58-676bd477cf10","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"0","type":"int","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f07a11f2-93a1-458f-88a2-56d6dbe5e281","internalID":"1af464e2-1b7f-44e1-806c-c6c3beafd78b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"expire_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm + source1.expire_after","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}],"_validationLog":["The variable &apos;expire_event_tm&apos; does not exist."]},{"id":"97144afc-2fef-4424-8629-065d3c681b0b","internalID":"ad1a040e-0b20-4b34-8c62-1af4a31186e8","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\r\n    import com.vitria.spark.api.scala.OperatorUtils._\r\n    val anomaly = event.source1.get\r\n    val metric_dev = anomaly.metric_deviation\r\n    val low_t = anomaly.threshold_low\r\n    val med_t = anomaly.threshold_med\r\n    val high_t = anomaly.threshold_high\r\n    val threshold_policy = anomaly.threshold_policy\r\n    val LOW = \"Low\"\r\n    val MED = \"Medium\"\r\n    val HIGH = \"High\"\r\n    val ABOVE = \"above\"\r\n    val BELOW = \"below\"\r\n    \r\n    var max_severity = ctx.getGlobalVar[String](\"max_severity\").getOrElse(\"\")\r\n    var derived_severity = LOW\r\n\r\n    def _GE(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GE v2\r\n      case BELOW =&gt; v1 LE (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    def _GT(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GT v2\r\n      case BELOW =&gt; v1 LT (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    val severity = if (_GT(metric_dev, high_t, threshold_policy)) {\r\n      derived_severity = HIGH\r\n      HIGH\r\n    } else if (_GT(metric_dev, med_t, threshold_policy)) {\r\n      derived_severity = MED\r\n      MED\r\n    } else if (_GT(metric_dev, low_t, threshold_policy)) LOW\r\n    else \"\"\r\n\r\n    def compare(s1: String, s2: String): String = {\r\n      def conv(s: String) = s match {\r\n        case HIGH   =&gt; 3\r\n        case MED =&gt; 2\r\n        case LOW    =&gt; 1\r\n        case _        =&gt; 0\r\n      }\r\n      if (conv(s1) &gt; conv(s2)) s1 else s2\r\n    }\r\n\r\n    max_severity = compare(compare(severity, derived_severity), max_severity)\r\n\r\n    ctx.setGlobalVar(\"severity\", severity)\r\n    ctx.setGlobalVar(\"derived_severity\", derived_severity)\r\n    ctx.setGlobalVar(\"max_severity\", max_severity)\r\n\r\n  "}]},{"id":"0f8c2ef3-ee2d-4e93-8551-877e1cdc4261","internalID":"fbc122da-d042-4be3-8698-1b327917ba85","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\nvar rv = (new java.util.Random()).nextInt(90000000)\nwhile (rv == 0) rv = (new java.util.Random()).nextInt(90000000)\nval rid = Math.abs(System.nanoTime % rv)\nval sdf = new java.text.SimpleDateFormat(\"yyyyMMddHHmm\")\nval dthm = sdf.format(new java.util.Date())\n//    val id = s\"\"\"${dv_lastToken}:${source1.sub_service}:${source1.anomaly_window}#${System.currentTimeMillis() / 1000 % 86400}\"\"\"\n//val id = s\"\"\"${dv_lastToken}:${dv_tokens(1)}:${source1.window}#${rid}\"\"\"\nval id = s\"\"\"${dthm}#${rid}\"\"\"\nctx.setGlobalVar(\"incident_id\", id)\n\n//Extract dimensions values\nval tokens = source1.metric_id.split(\"\\\\|\")\nval dvalue=if(tokens.size&gt;4) tokens.drop(4).mkString(\"[\\\"\",\"\\\",\\\"\",\"\\\"]\") else \"[]\"\nctx.setGlobalVar(\"dim_values\",Some(dvalue))\n\n\n//set Timer\nval expiredDuration = source1.expire_after\nval expiredTime = expiredDuration.getOrElse(86400L) + System.currentTimeMillis()/1000L\nctx.resetTimer(\"Timer\", ExpirationTimerSpec(expiredDuration.getOrElse(86400L),1))\nctx.setGlobalVar(\"expire_tm\",Some(expiredTime))\n\n// for logging\nctx.setGlobalVar(\"expire_tm_duration\",expiredDuration.getOrElse(86400L))\nctx.setGlobalVar(\"late_tm_duration\", if(source1.late_data_timer&gt;0) source1.late_data_timer else 86400L)\n\nval LOW = \"Low\"\nval MED = \"Medium\"\nval HIGH = \"High\"\nval severity = ctx.getGlobalVar[String](\"severity\").get\nval msg = if (HIGH.equals(severity)) SimpleDevMsg.BEGIN_STAY_HIGH_REASON\n          else if (MED.equals(severity)) SimpleDevMsg.BEGIN_STAY_MED_REASON\n          else SimpleDevMsg.BEGIN_STAY_LOW_REASON\nval reason = IncidentMsgUtils.replaceVars(msg, (MsgVars.var_low_threshold,  source1.threshold_low),\n                                               (MsgVars.var_med_threshold,  source1.threshold_med), \n                                               (MsgVars.var_high_threshold, source1.threshold_high))\nctx.setGlobalVar(\"reason\", reason)\nval action = IncidentActionMsg.INCIDENT_START + IncidentActionMsg.BEGIN_AT\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"347de343-d6f1-4bd7-81c6-5f9e2b8a559d","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"","type":null,"option":false},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":null,"option":false},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"1c169150-bccd-4a67-8ebb-b2bc1de79cbf","internalID":"ffadba39-7654-4728-8145-be11cd84b675","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"source1.late_data_timer&lt;=0","type":"boolean","option":true}}]},{"id":"29314cd5-6fb5-4bc5-81d0-35aef2746c18","internalID":"cb6acf51-8732-417c-87d8-3f97ccfd8f98","ref":"ResetTimer","desc":"Reset timer {timer_event} with timer specification {timer_spec} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"timer_spec","type":"timer_spec","editorType":"sle","literalValue":"$.text","value":{"text":"IdleTimerSpec(to_nonoption(source1.late_data_timer), 1)","type":"com.vitria.spark.sm.TimerSpec","option":false}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"source1.late_data_timer&gt;0","type":"boolean","option":true}}]},{"id":"b591ac3f-83e3-4d8b-817b-0d2e78cfeeb4","internalID":"3ffc2dcc-d91c-433c-8382-e32a30b0b534","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"derived_severity","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"91bf910f-dd15-4f2e-813f-d6a92fea1d67","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"dbc1ed6a-764d-4704-8591-edf0b1419925","internalID":"7f43199f-dcc2-4543-8606-050b7fadef0a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"late_tm_duration"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.late_data_timer","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"source1.late_data_timer &gt; 0","type":"boolean","option":true}}]}]},"priority":0,"srcId":"Start","tgtId":"State","labelLoc":0.6075268817204301},{"srcId":"Start","tgtId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","label":"Pre-Incident","event":"","condition":{"text":"source1.warmup_rule","type":"boolean","option":true},"action":{"statements":[{"id":"22e63807-4067-42eb-829d-f1e37761d8ad","internalID":"e007f740-12f6-4118-8928-db63d352b8d2","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"warmup_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm - source1.start_tm","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3e72b53a-6d96-49aa-8fcb-22f7e83ee559","internalID":"aa2b6e7c-5a78-4b3e-8645-e81dfcd558b7","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"state"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Warmup\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4ce813f8-c1f0-44a6-8402-7738f44c8fc9","internalID":"aa2b6e7c-5a78-4b3e-8645-e81dfcd558b7","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Warmup\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a2e1650b-2453-42d1-8675-7db97b23abed","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"99deb18c-1cce-48be-86dc-10cb2c3d00ef","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"algorithm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.algorithm","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1dd8b524-785b-4446-8a73-6effb1a9969f","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_policy"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_policy","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"9fd96401-8f07-4c63-80c8-d4a40ee5264d","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6e41e796-1d9c-4556-866e-57639320a138","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"4baf1e82-3d6d-495d-82b2-8de3e5b6d9e6","internalID":"ce7da8cf-c1e0-4044-8a88-e8196c07aa8a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"date_key"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.date_key","type":"integer","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"86222b7b-b3e8-4cd5-8c17-88f1afa84a4f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3913741b-5885-463e-8e08-b28e53b87df8","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3e065a24-07d2-4381-8a4f-866af47f8322","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"71ce31fb-0d72-49b9-89dd-31456ed00327","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"32062058-0f2e-459b-8a2d-b83fd0ed873f","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"69b1db0f-ba1c-4cb3-8721-f08f7395a366","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e5b56600-44d2-4ce4-83b7-83aef474eefc","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e2d7af01-6c72-4635-8e45-48036eb855a0","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"70326926-119a-46fa-8727-7cdd397fd69c","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e62b1717-1a90-4a39-89f1-a13772a4c80c","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a5c0d3a9-5aca-4b7a-86af-84fdfda9d517","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d6ddb2e8-6bbc-4c61-85c8-8a6d88a2c83f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"61990ebb-531a-406b-836b-ea6233b59a5f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"121f6266-ee6d-4157-8658-254cbd5bdd24","internalID":"28cc64f9-cbbc-4190-8178-b7bb8e8bcfc4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c2edf93e-0fa5-467b-8825-620b5d0f4d43","internalID":"28cc64f9-cbbc-4190-8178-b7bb8e8bcfc4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"max_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Warmup\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"b4aa7824-33d4-4913-8c20-784f13bbc411","internalID":"28cc64f9-cbbc-4190-8178-b7bb8e8bcfc4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"derived_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Warmup\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"68dfb383-950b-41cc-8fb9-2e7b511d555b","internalID":"180a0c6f-6e79-4b4c-8bea-2de5a7c7f5a5","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"config_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.config_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"f87fc9f4-98c3-4126-8402-d10bad4c7d98","internalID":"4e0a264c-7092-49e2-8901-5c35e2371553","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"dim_keys"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.dim_keys","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a64aa926-6a35-4622-8700-97041b5b5410","internalID":"4e0a264c-7092-49e2-8901-5c35e2371553","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"dim_pattern"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.dim_pattern","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"75a18bae-63c9-4476-85e9-5ac85eb06bf8","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ad985745-4bfd-475c-8129-3b72882fa3d8","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"sub_service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.sub_service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e98a042d-7157-4f24-8076-2e724feac35e","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_time"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.correlation_time","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"85e912ae-e645-4743-8721-9f675c34dfd7","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"groupable"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.groupable","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"da54c388-1b75-4b41-8ff2-69c9d597399f","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"1773aea9-1917-420c-8a9f-fb8dcb78a7be","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"mode"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.mode","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","type":"boolean","option":false}}]},{"id":"2315d015-3227-4681-8cde-877ba3bb2a7a","internalID":"2a6c118f-5cfb-4a69-896f-8fbf19ac21d8","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"max_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.max_warmup_per","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5f5d94a0-579b-4756-8fb4-b0ae978b8b3f","internalID":"8fdafc34-0581-4298-8df0-0faf1d2c628a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cooldown_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.cool_down_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"26ca5bdd-0b58-4d74-8bd6-da0c16f21e6c","internalID":"14e6465a-5c05-40cf-8d94-e72ab5a9f468","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.warmup_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"cfad67e5-b91b-48c0-8fe8-c1b203adda2a","internalID":"ee960512-a529-481c-81ad-0a74aba9dcfe","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_qualified_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.anomaly_interval","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6e329584-de8b-4566-8c51-70793cd4d2dc","internalID":"8feb4b7f-c304-4829-8b4a-f8cffa3e6a24","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.anomaly_interval","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"24195e50-660c-453b-8f6f-f89a791e5820","internalID":"e9aa2e9c-475d-460c-8b58-676bd477cf10","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"0","type":"int","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e96f0e4c-22a8-493d-8cf7-836e219ab0ff","internalID":"1af464e2-1b7f-44e1-806c-c6c3beafd78b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"expire_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm + source1.expire_after","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6bc4b828-4ffb-4567-80ef-3ecb4aba7f8c","internalID":"fbc122da-d042-4be3-8698-1b327917ba85","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\nvar rv = (new java.util.Random()).nextInt(90000000)\nwhile (rv == 0) rv = (new java.util.Random()).nextInt(90000000)\nval rid = Math.abs(System.nanoTime % rv)\nval sdf = new java.text.SimpleDateFormat(\"yyyyMMddHHmm\")\nval dthm = sdf.format(new java.util.Date())\n//    val id = s\"\"\"${dv_lastToken}:${source1.sub_service}:${source1.anomaly_window}#${System.currentTimeMillis() / 1000 % 86400}\"\"\"\n//val id = s\"\"\"${dv_lastToken}:${dv_tokens(1)}:${source1.window}#${rid}\"\"\"\nval id = s\"\"\"${dthm}#${rid}\"\"\"\nctx.setGlobalVar(\"incident_id\", id)\n//Extract dimensions values\nval tokens = source1.metric_id.split(\"\\\\|\")\nval dvalue=if(tokens.size&gt;4) tokens.drop(4).mkString(\"[\\\"\",\"\\\",\\\"\",\"\\\"]\") else \"[]\"\nctx.setGlobalVar(\"dim_values\",Some(dvalue))\n\n//set Timer\nval expiredDuration = source1.expire_after\nval expiredTime = expiredDuration.getOrElse(86400L) + System.currentTimeMillis()/1000L\nctx.resetTimer(\"Timer\", ExpirationTimerSpec(expiredDuration.getOrElse(86400L),1))\nctx.setGlobalVar(\"expire_tm\",Some(expiredTime))\n\n// for logging\nctx.setGlobalVar(\"expire_tm_duration\",expiredDuration.getOrElse(86400L))\nctx.setGlobalVar(\"late_tm_duration\", if(source1.late_data_timer&gt;0) source1.late_data_timer else 86400L)\n\nval msg = SimpleDevMsg.BEGIN_STAY_WARMUP_REASON_QUAL\nval reason = IncidentMsgUtils.replaceVars(msg,\n   (MsgVars.var_low_threshold, source1.`threshold_low`),\n   (MsgVars.var_min_metric_val, source1.`min_metric_vol`),\n   (MsgVars.var_warmup_period, source1.`warmup_period`))\nctx.setGlobalVar(\"reason\", reason)\nval action = IncidentActionMsg.BEGIN\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"cf8fc437-f869-4974-8553-74d94d9558b2","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"warmup_dur","type":"long","option":true},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"6c0ee628-f47d-42be-8391-437705480fa5","internalID":"ffadba39-7654-4728-8145-be11cd84b675","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"source1.late_data_timer&lt;=0","type":"boolean","option":true}}]},{"id":"d69cbfe0-4745-4d29-86e3-304e6dcd4b38","internalID":"cb6acf51-8732-417c-87d8-3f97ccfd8f98","ref":"ResetTimer","desc":"Reset timer {timer_event} with timer specification {timer_spec} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"timer_spec","type":"timer_spec","editorType":"sle","literalValue":"$.text","value":{"text":"IdleTimerSpec(to_nonoption( source1.late_data_timer), 1)","type":"com.vitria.spark.sm.TimerSpec","option":false}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"source1.late_data_timer&gt;0","type":"boolean","option":true}}]},{"id":"5fe7f097-16fe-4813-826e-36b6f39249ee","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e9d3fc68-a898-426b-828d-b7e7025c4030","internalID":"7f43199f-dcc2-4543-8606-050b7fadef0a","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"late_tm_duration"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.late_data_timer","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"source1.late_data_timer &gt; 0","type":"boolean","option":true}}]}]},"priority":0,"fromState":"Start","toState":"Warmup","_id":"con_42","labelLoc":0.4171779141104294},{"srcId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","tgtId":"State","label":"Exceed Warmup","event":"","condition":{"text":"source1.warmup_rule and (cur_qualified_per +source1.anomaly_interval &gt;= warmup_per)","type":"boolean","option":true},"action":{"statements":[{"id":"fc35a99e-cf83-4af4-844b-3b571101846b","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Create\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"612cac08-dd98-4b85-8127-31d8e08eeafd","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"state"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Active\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c21dd3e1-10de-4bb4-89d2-27b657ba429d","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"start_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"dfa55991-777b-44f8-8fbf-264e13c779d6","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ecffdee1-6279-4f3a-80d0-099c401196c5","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c76ef98f-312d-456c-8fb0-d9f3cacb4be8","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1010e4cc-f5af-4e77-80d8-78ca13ef74cd","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"3bd6fba5-5901-4704-8798-a88ac2fdff78","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d71a4c64-28c9-407a-8989-740cd995f611","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"71b008a3-cae0-44c5-89ad-94850baad671","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"afa186bb-531f-49ee-8513-63d3c4ff6305","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a48778ea-3317-40a6-85c6-0004c95760df","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"75f68a52-94a7-4250-87cf-476ddfc35239","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"0ce8ab09-99d3-4095-86d9-a08706e7da93","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"613cf762-bcc5-49b6-8e2d-5e0769128817","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"35b29905-a22f-45fd-8cdc-921633eea81a","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1f477b60-1957-466b-837d-4c2aced7f389","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ff75d430-1433-4188-8b8d-3441f094b85e","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"8b0ee9c0-45f6-48ff-819f-d3be93f44d8f","internalID":"ad1a040e-0b20-4b34-8c62-1af4a31186e8","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\r\n    import com.vitria.spark.api.scala.OperatorUtils._\r\n    val anomaly = event.source1.get\r\n    val metric_dev = anomaly.metric_deviation\r\n    val low_t = anomaly.threshold_low\r\n    val med_t = anomaly.threshold_med\r\n    val high_t = anomaly.threshold_high\r\n    val threshold_policy = anomaly.threshold_policy\r\n    val LOW = \"Low\"\r\n    val MED = \"Medium\"\r\n    val HIGH = \"High\"\r\n    val ABOVE = \"above\"\r\n    val BELOW = \"below\"\r\n    \r\n    var max_severity = ctx.getGlobalVar[String](\"max_severity\").getOrElse(\"\")\r\n    var derived_severity = LOW\r\n\r\n    def _GE(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GE v2\r\n      case BELOW =&gt; v1 LE (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    def _GT(v1: Option[Double], v2: Option[Double], policy: String): Boolean = (policy match {\r\n      case ABOVE =&gt; v1 GT v2\r\n      case BELOW =&gt; v1 LT (v2 MUL Option(-1.0))\r\n      case _       =&gt; None\r\n    }).getOrElse(false)\r\n\r\n    val severity = if (_GT(metric_dev, high_t, threshold_policy)) {\r\n      derived_severity = HIGH\r\n      HIGH\r\n    } else if (_GT(metric_dev, med_t, threshold_policy)) {\r\n      derived_severity = MED\r\n      MED\r\n    } else if (_GT(metric_dev, low_t, threshold_policy)) LOW\r\n    else \"\"\r\n\r\n    def compare(s1: String, s2: String): String = {\r\n      def conv(s: String) = s match {\r\n        case HIGH   =&gt; 3\r\n        case MED =&gt; 2\r\n        case LOW    =&gt; 1\r\n        case _        =&gt; 0\r\n      }\r\n      if (conv(s1) &gt; conv(s2)) s1 else s2\r\n    }\r\n\r\n    max_severity = compare(compare(severity, derived_severity), max_severity)\r\n\r\n    ctx.setGlobalVar(\"severity\", severity)\r\n    ctx.setGlobalVar(\"derived_severity\", derived_severity)\r\n    ctx.setGlobalVar(\"max_severity\", max_severity)\r\n\r\n  "}]},{"id":"f8ba9888-4a9c-4d57-8773-7c8a0853336b","internalID":"99c2c9ab-30c6-4a45-88a0-3ac3c5d2b87b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"active_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm - source1.start_tm","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"severity!=\"\"","type":"boolean","option":true}}]},{"id":"6feaf579-1fb5-4dd2-8338-ac043c2ba080","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_active_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.end_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"529a8ef2-a5e5-4d56-8e5b-479ee0fa709d","internalID":"a20fc4d5-1e2c-4b13-875c-0d0ec25e5107","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"warmup_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"warmup_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"200e5f67-9884-482e-8411-083583a95d40","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5b3def9e-76b8-4c2b-8e63-d80821485a09","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"sub_service_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.sub_service_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"17e6af2e-dfc0-4b87-830c-4cc70eacc2d7","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"c222211b-4e23-455e-8bde-518f7ad4ccfe","internalID":"c5b98fe9-733e-4998-83de-8caaf3aba6c6","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1= event.source1.get\r\nval LOW = \"Low\"\r\nval MED = \"Medium\"\r\nval HIGH = \"High\"\r\nvar severity = ctx.getGlobalVar[String](\"severity\").getOrElse(\"\")\r\nval msg = if (HIGH.equals(severity)) SimpleDevMsg.BEGIN_STAY_HIGH_REASON\r\n          else if (MED.equals(severity)) SimpleDevMsg.BEGIN_STAY_MED_REASON\r\n          else SimpleDevMsg.BEGIN_STAY_LOW_REASON\r\nval reason = IncidentMsgUtils.replaceVars(msg, (MsgVars.var_low_threshold, source1.threshold_low),\r\n                                               (MsgVars.var_med_threshold, source1.`threshold_med`), \r\n                                               (MsgVars.var_high_threshold, source1.`threshold_high`))\r\nctx.setGlobalVar(\"reason\", reason)\r\nval action = IncidentActionMsg.INCIDENT_START + IncidentActionMsg.BEGIN_AT\r\nctx.setGlobalVar(\"action\", action)\r\n\r\n    "}]},{"id":"0915a443-be55-4197-86d9-3d2094abbf7d","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"warmup_dur","type":"long","option":true},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"39269ce7-15a9-4c85-89e9-820a1941724a","internalID":"22e5e424-43d2-44f0-8187-4c615300d082","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_severity"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"derived_severity","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"32e5600c-f643-454d-8b32-557f509a2fbb","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":0,"fromState":"Warmup","toState":"Active","_id":"con_54","labelLoc":0.44761904761904764},{"srcId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Expire (Warmup)","event":"","condition":{"text":" source2.virtual_event_tm &gt; expire_event_tm ","type":"boolean","option":true},"action":{"statements":[{"id":"ee1de90f-d4b6-4a38-805d-f3958f9ded56","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Expire\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"8c23d7e7-5671-42ab-8a53-090081d89f1b","internalID":"bbc454bb-9bb7-4a47-89ed-a3137cdb909d","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\nval action = IncidentActionMsg.ABORT\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.EXPIRED_REASON, (MsgVars.var_expired_tm_duration, ctx.getGlobalVar[Long](\"expire_tm_duration\")))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"f909f445-3dd4-468a-8feb-b9f6407b0a84","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"expire_event_tm","type":"long","option":true},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"expire_event_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_event_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"config_metric_id":{"text":"config_metric_id\n","type":"string","option":true},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]}]},"priority":0,"fromState":"Warmup","toState":"End","_id":"con_92"},{"srcId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","tgtId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","label":"Continue Warmup","event":"","condition":{"text":"cur_warmup_per + source1.anomaly_interval &lt; max_warmup_per","type":"boolean","option":true},"action":{"statements":[{"id":"d2397406-3550-478f-8a1f-969a55257b94","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1150afdc-7c57-4670-8a5a-e0aeb5c713e7","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"63c9d5d8-a960-48fe-8c3a-b1cdca82349f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d9a5353c-7ad3-4156-8a60-c5b280647901","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"9b608673-93bc-43d3-8d47-9f0b38d7764c","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a4660623-03a3-493e-866d-daa3b814629b","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"777f1472-5756-4330-8942-d8d247a94cb3","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"1afdbc28-c6d1-4337-8cd2-c141a14cb036","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"82f152be-4bce-46d0-83cd-a07562eccdb5","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"319c8941-ebd6-4771-8b99-f803fbb9c197","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"5e1f82fc-6704-4785-844f-d93ad08aae27","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a721dba7-8b2f-4df9-8ec0-7865f64dc0c7","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6719c51f-3278-4946-819d-1b69ec27987f","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"7fb054e4-cabd-4eb2-840a-8742047af1b5","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"01231a3d-d419-44a2-870f-efa413534380","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6e7fa263-ff83-4ba9-8cdc-98ec0b352d6d","internalID":"a20fc4d5-1e2c-4b13-875c-0d0ec25e5107","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"warmup_dur"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"warmup_dur+source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c60f9537-53bd-48dd-8762-c90703d85b17","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"34e0faac-d373-4dd4-8d50-cc150ad33669","internalID":"ee960512-a529-481c-81ad-0a74aba9dcfe","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_qualified_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"cur_qualified_per + source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"source1.warmup_rule","type":"boolean","option":true}}]},{"id":"b53e60a5-1864-414f-8366-8a7ca1212ebb","internalID":"8feb4b7f-c304-4829-8b4a-f8cffa3e6a24","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"cur_warmup_per + source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"77e5d176-d15a-46c3-8dd9-5e36ac271781","internalID":"54ccd88a-c4a6-4278-8936-91f21f8d8364","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\r\n// for loggig\r\n// TODO Message  is not correct ?? for unqual, same as qulified\r\nval msg = if(source1.`low_threshold_rule`.get || source1.`warmup_rule`.get)\r\n             SimpleDevMsg.BEGIN_STAY_WARMUP_REASON_QUAL\r\n          else \r\n             SimpleDevMsg.BEGIN_STAY_WARMUP_REASON_UNQUAL\r\nval reason = IncidentMsgUtils.replaceVars(msg,\r\n  (MsgVars.var_low_threshold, source1.`threshold_low`),\r\n  (MsgVars.var_min_metric_val, source1.`min_metric_vol`),\r\n  (MsgVars.var_warmup_period, source1.`warmup_period`))\r\nctx.setGlobalVar(\"reason\", reason)\r\nval action = IncidentActionMsg.CONTINUE\r\nctx.setGlobalVar(\"action\", action)\r\n"}]},{"id":"834f6955-2a8f-47d7-8301-907dbe551f1f","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"0","type":"int","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"warmup_dur","type":"long","option":true},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"dc274626-c317-40ff-8adb-9dabd3bfb7b4","internalID":"2d417f99-9f9f-4682-82fb-e9c02d720bc0","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"last_event_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]}]},"priority":1,"fromState":"Warmup","toState":"Warmup","_id":"con_66","labelLoc":0.5},{"srcId":"caa9b573-922a-4e9a-80aa-eda1538e7bf1","tgtId":"6e7ad0f0-25ba-4cf4-8e6b-8dca6d50fd8f","label":"Close Incident (Warmup)","event":"","condition":{"text":"cur_warmup_per + source1.anomaly_interval &gt;= max_warmup_per","type":"boolean","option":true},"action":{"statements":[{"id":"10e9f7c6-ee35-48e5-8d58-898c61c7023a","internalID":"0ae4dbef-e75b-48dd-820e-f24f5d563d93","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ed6f11ac-20fb-4189-8208-239f276b0e0b","internalID":"d4403de2-e4ad-402f-8763-318f574cbe89","ref":"CancelTimer","desc":"Cancel timer {timer_event} on condition {condition}","bindings":[{"field":"timer_event","type":"timer_event","editorType":"select","value":"Late_Timer"},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"17350bde-49ed-4c83-8303-bafe3b2c77d4","internalID":"79606b96-500f-43ea-8ac4-6d37504e82b2","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Close\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"07b3930e-c526-400e-8156-b08f0c9536eb","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"window"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.window","type":null,"option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"241e3dd3-da7b-43e5-8ab8-7609292a3c13","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"emit_notification"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.emit_notification","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"95e43c8c-cd0c-48e3-88af-0c40f6009687","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d187864b-efc6-47c4-88da-ceed8aa3325b","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"contextual_metric_id"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.contextual_metric_id","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"7bac5aeb-1ce2-4bfe-80af-d30f11fdb1db","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"ad3054b8-5c68-43c1-857e-b5283b56a004","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_top_count"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_top_count","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"cf71b322-3bc1-4d9f-8892-6438217fb5e4","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_min_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_min_measure","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"d4209e3b-7c9b-4d13-8aea-1d2432f146e9","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_rule_name"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_rule_name","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"c5f0eb9b-98b0-4adf-8f8f-9e658a9f1efb","internalID":"2b6da772-70c2-4f98-865d-9f343afe8af4","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"causation_suppl_measure"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.causation_suppl_measure","type":"string","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a1f37c89-319d-4c35-8830-0fb06d87b228","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_low"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_low","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"8fc6b554-c5d4-484f-8413-a3fcb0dc8d82","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_med"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_med","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"e49815c0-9d25-4192-889d-582ae869dba7","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"threshold_high"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.threshold_high","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"a2801aa4-ea2c-4341-8619-8ffd2eb894e5","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"med_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.med_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"14c31118-f7a0-4b9b-861e-24aae2ed2746","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"high_threshold_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.high_threshold_period","type":"long","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"95055486-fe1e-48ef-8ccb-da6fbad73e30","internalID":"28855f07-7a24-4c01-8c84-eff3253a2959","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"min_metric_vol"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.min_metric_vol","type":"double","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"9f669cec-8f8f-4e9d-8730-d8b9b9fde331","internalID":"6e5c8c9d-5f5e-46b8-8253-550866525b89","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"correlation_end_tm"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"source1.start_tm+correlation_time","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"groupable=&apos;y&apos;","type":"boolean","option":true}}]},{"id":"9553b9ee-188b-4387-802f-2d1b4a7884a5","internalID":"e9aa2e9c-475d-460c-8b58-676bd477cf10","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"cur_warmup_per"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"cur_warmup_per +  source1.anomaly_interval","type":"number","option":true}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"acd61726-a266-45fc-8455-3375d30a758a","internalID":"61e40c0d-a485-4a2c-8742-a044de339d3b","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"val source1 = event.source1.get\r\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.ABORT_WARMUP, (MsgVars.var_max_warmup_periods, ctx.getGlobalVar(\"max_warmup_per\")))\r\nctx.setGlobalVar(\"reason\", reason)\r\nctx.setGlobalVar(\"action\", IncidentActionMsg.ABORT)"}]},{"id":"036ab10f-c226-432e-867b-2482f9b355a6","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"source1.start_tm","type":"long","option":false},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"source1.start_tm","type":"long","option":false},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"warmup_threshold":{"text":"","type":null,"option":false},"warmup_duration":{"text":"warmup_dur","type":"long","option":true},"cooldown_duration":{"text":"","type":null,"option":false},"dim_keys":{"text":"source1.dim_keys","type":"string","option":false},"dim_values":{"text":"dim_values","type":"string","option":true},"config_metric_id":{"text":"config_metric_id","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]}]},"priority":2,"fromState":"Warmup","toState":"End","_id":"con_78","labelLoc":0.3829787234042553}],"events":[],"variables":[{"name":"_modelStartTime","type":"long","defaultValue":{"text":"","type":"string","option":false},"_deletable":false,"_disabled":true,"_id":"583f9214-6d13-4dec-86d0-1ca4c962899e"},{"name":"_latestEventTime","type":"long","defaultValue":{"text":"","type":"string","option":false},"_deletable":false,"_disabled":true,"_id":"bd9a6047-ffd8-49fc-89d9-f1d489e49ca2"},{"name":"_startEventTime","type":"long","defaultValue":{"text":"","type":"string","option":false},"_deletable":false,"_disabled":true,"_id":"6a64b96f-f549-41a4-88b5-bc2c27074375"},{"_id":"10283cf8-074c-4cff-8ac3-89b6f436234f","name":"metric_id","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"a85986f5-3f86-49a9-8bd2-4bbecfe07380","name":"window","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"b23328b7-43d4-4cef-8c2d-e37f8eebd42e","name":"algorithm","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"b3561fa4-f63e-45d7-8ea0-0a8e4b8a9354","name":"generated","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"e31797d9-2842-4941-83b9-23490959c9cf","name":"threshold_policy","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"9483d6a0-e5aa-45eb-8254-f818007d6c99","name":"emit_notification","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"30e5c709-58f9-4dc8-8323-380651e4519b","name":"threshold_low","type":"double","defaultValue":{"text":"","type":"string","option":false}},{"_id":"07206cf2-48fe-4ce3-8d69-60ebad585aeb","name":"threshold_med","type":"double","defaultValue":{"text":"","type":"string","option":false}},{"_id":"b2f6acc1-6a6a-4ea6-878c-47a91baff09e","name":"threshold_high","type":"double","defaultValue":{"text":"","type":"string","option":false}},{"_id":"1611e6bc-2cb7-426b-858f-67e9fedfc1a7","name":"med_threshold_per","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"ac1280ab-ba1d-48ec-8224-7e238a5c817a","name":"high_threshold_per","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"05cff34c-e889-4bf3-886e-65d0b2f728cf","name":"min_metric_vol","type":"double","defaultValue":{"text":"","type":"string","option":false}},{"_id":"72005df7-677c-4921-87d0-c3a62111b2cf","name":"causation_measure","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"ddc90afe-85d1-4900-8877-4e152023180c","name":"causation_min_measure","type":"double","defaultValue":{"text":"","type":"string","option":false}},{"_id":"c702e6b0-75b7-498d-8576-120376f14e8e","name":"causation_top_count","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"4bc80479-f062-4a39-8746-43d28cadef88","name":"causation_rule_name","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"f29deea6-133b-4a66-84b0-3fc60dc7a1fe","name":"causation_suppl_measure","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"f0db9fb3-1ded-4d23-8173-fa37566e5f64","name":"contextual_metric_id","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"6c01e2a7-7138-40d7-8ef4-22bb9122dffa","name":"operation","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"7d6668cf-dae5-4a71-82ff-a073b0829c6d","name":"state","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"918c6a16-6971-4ede-8d3f-783434ab43b3","name":"active_dur","type":"long","defaultValue":{"text":"0","type":"int","option":false}},{"_id":"083c6ca8-8ef7-4836-8262-2a9bbed04df1","name":"cooldown_dur","type":"long","defaultValue":{"text":"0","type":"int","option":false}},{"_id":"e5e14c2a-a899-44d6-8a95-0058bee936a7","name":"warmup_dur","type":"long","defaultValue":{"text":"0","type":"int","option":false}},{"_id":"f86ba69b-1c21-4699-8637-3dd10c4e0173","name":"start_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"53d84a39-5ebf-4f62-8404-7d07d7a7fea7","name":"date_key","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"a40eae9c-9878-497a-888c-5d49331175ac","name":"severity","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"433799f0-06e4-4fb7-8b7a-0414e834e57d","name":"derived_severity","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"bf815df6-cd22-4e83-898a-4af6faa068de","name":"max_severity","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"52b4f672-e1fe-4583-86a7-5564b730c9a1","name":"incident_id","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"8bc7b2fc-85f4-4745-8a36-159750699c0d","name":"expire_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"c01c7bf4-fe15-4e28-82b9-81b258e09a8a","name":"config_metric_id","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"0cfb895a-b800-4a74-8edc-0624dc53bad0","name":"dim_keys","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"c0a66eae-7ee5-4bc8-85f5-7b460fa0ad85","name":"dim_values","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"1f16a574-671f-4857-8a25-921eed9c3b8a","name":"dim_pattern","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"82f70a40-cddb-4719-8888-9bc310d00225","name":"last_active_end_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"35be60d6-977f-4138-876d-cccbe3bb4c10","name":"service_name","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"a3b12acf-88fa-4a8c-8d6f-d8900c96d72c","name":"sub_service_name","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"de83ecc3-ff94-4ec6-8f96-2ca1dcd33efe","name":"correlation_time","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"0e482aa2-0176-4a7d-8d80-c4eadb42938c","name":"groupable","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"2129e604-948c-4216-8622-e296d8ad0c7e","name":"correlation_end_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"e1802beb-a916-46c9-839f-64e2b714d72e","name":"mode","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"80eb82c1-7622-4c3f-8e27-e7d142179654","name":"cur_qualified_per","type":"long","defaultValue":{"text":"","type":null,"option":false}},{"_id":"67fbfe3f-f126-4944-87ae-56426acde058","name":"cur_warmup_per","type":"long","defaultValue":{"text":"","type":null,"option":false}},{"_id":"44af19db-b93f-4c2d-8660-5a97645444d6","name":"max_esc_severity","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"1633f79b-5c21-415a-8c64-beac70646e60","name":"active_per","type":"long","defaultValue":{"text":"","type":null,"option":false}},{"_id":"e83f8bc6-89df-475e-8045-5a23e6328e3f","name":"max_warmup_per","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"44c0ac75-1fc2-47e1-80cf-d9f75df2d5c5","name":"warmup_per","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"6b5899fe-d6c0-40fb-81fe-d598f71f32a0","name":"reason","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"375bb963-9990-4eb3-8d8d-e5c6258b87e3","name":"action","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"13c96ef7-cf6e-4df2-8596-c6b28a1c6581","name":"last_severity","type":"string","defaultValue":{"text":"","type":"string","option":false}},{"_id":"2dcb8b7d-de75-4b2f-876a-93a999268cc0","name":"expire_tm_duration","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"b49a078a-1f15-4a58-8813-28a7bda5eeb5","name":"late_tm_duration","type":"long","defaultValue":{"text":"24 * 60 *60","type":"number","option":false}},{"_id":"08c5a3d2-1e7a-4ab2-8e76-41f187d490ef","name":"cooldown_per","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"5237f0e1-eacb-411d-89e3-ef025ab04313","name":"last_event_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}},{"_id":"9bdc87d9-a608-486b-869e-15f6c092cb40","name":"last_max_esc_severity","type":"string","defaultValue":{"text":"\"\"","type":"string","option":false}},{"_id":"24347f0e-3edf-4338-8404-eb1dc3a6e411","name":"expire_event_tm","type":"long","defaultValue":{"text":"","type":"string","option":false}}],"aggregates":[],"globalTimers":[{"_id":"8ba0986a-fafb-422e-8aee-d20aea647cc8","timer":"Timer","spec":{"text":"ExpirationTimerSpec(86400,1)","type":"com.vitria.spark.sm.TimerSpec","option":false},"action":{"statements":[{"id":"91b16d41-c500-4e18-85da-3fde4da90a82","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Expire\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"37a817d1-4c3f-4f7d-85a3-973c039e9f54","internalID":"bbc454bb-9bb7-4a47-89ed-a3137cdb909d","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\nval action = if(\"Cooldown\".equals(ctx.currentStateName.trim)) \n                  IncidentActionMsg.CONTINUE\n             else if(\"Active\".equals(ctx.currentStateName.trim)) \n                  IncidentActionMsg.INCIDENT_END +  IncidentActionMsg.ABORT\n             else IncidentActionMsg.ABORT\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.EXPIRED_REASON, (MsgVars.var_expired_tm_duration, ctx.getGlobalVar[Long](\"expire_tm_duration\")))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"00087caf-77fa-4984-8104-b182d680cd77","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"expire_tm","type":"long","option":true},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"expire_tm","type":"long","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"config_metric_id":{"text":"config_metric_id\n","type":"string","option":true},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"a26b5f4f-17f7-4e85-8ca1-a8a7c9fb39b4","internalID":"ea71b892-5a27-48e4-88f6-e0b150da5af4","ref":"EndInstance","desc":"End instance on condition {condition}","bindings":[{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]}]}},{"_id":"27bdc437-a4f7-4c0e-84c4-148f3228fca4","timer":"Late_Timer","spec":{"text":"IdleTimerSpec(86400,1)","type":"com.vitria.spark.sm.TimerSpec","option":false},"action":{"statements":[{"id":"30e65c63-daaf-4aa6-848a-945dc70771b2","internalID":"0131dd03-eae9-47e6-8915-1a9d9133e38b","ref":"AssignVar","desc":"Assign variable {variable} from expression {expression} on condition {condition}","bindings":[{"field":"variable","type":"variable","editorType":"select","value":"operation"},{"field":"expression","type":"expression","editorType":"sle","literalValue":"$.text","value":{"text":"\"Close\"","type":"string","option":false}},{"field":"condition","type":"condition","editorType":"sle","defaultValue":{"text":"true","option":"false","type":"boolean"},"literalValue":"$.text","value":{"text":"true","option":"false","type":"boolean"}}]},{"id":"6468420e-94db-4c8d-8dde-10fad8c2b583","internalID":"61e7ea69-c163-46f0-8600-78a53aed039b","ref":"CustomCode","desc":"Custom code {scala_editor}","bindings":[{"field":"scala_editor","type":"scala_editor","editorType":"scripteditor","literalValue":"CODE","value":"\nval action = if(\"Cooldown\".equals(ctx.currentStateName.trim)) \n                  IncidentActionMsg.CONTINUE\n             else if(\"Active\".equals(ctx.currentStateName.trim)) \n                  IncidentActionMsg.INCIDENT_END +  IncidentActionMsg.ABORT\n             else IncidentActionMsg.ABORT\nval reason = IncidentMsgUtils.replaceVars(SimpleDevMsg.TIMEOUT_REASON, (MsgVars.var_max_data_interval, ctx.getGlobalVar(\"late_tm_duration\")))\nctx.setGlobalVar(\"reason\", reason)\nctx.setGlobalVar(\"action\", action)\n"}]},{"id":"faf19bf2-af0a-4925-8d98-e3304431fa4d","internalID":"928f0408-30fc-4762-8bb0-3aa165f3b65a","ref":"OutputEvent","desc":"Output event to output port {output_port} with mapping {output_mapping} on condition {condition}","bindings":[{"field":"output_port","type":"output_port","editorType":"selectWithDynLabel","value":"0","label":"ip"},{"field":"output_mapping","type":"output_mapping","editorType":"outputmapping","literalValue":"DATA","value":{"start_tm":{"text":"start_tm","type":"long","option":true},"id":{"text":"incident_id","type":"string","option":true},"event_tm":{"text":"expire_tm","type":"long","option":true},"date_key":{"text":"date_key","type":"long","option":true},"end_tm":{"text":"last_event_tm + late_tm_duration","type":"number","option":true},"operation":{"text":"operation","type":"string","option":true},"state":{"text":"state","type":"string","option":true},"metric_measure":{"text":"source1.metric_measure","type":"double","option":false},"metric_baseline":{"text":"source1.metric_baseline","type":"double","option":true},"score":{"text":"source1.score","type":"double","option":true},"max_severity":{"text":"max_severity","type":"string","option":true},"metric_deviation":{"text":"source1.metric_deviation","type":"double","option":false},"causation_measure":{"text":"causation_measure","type":"string","option":true},"causation_top_count":{"text":"causation_top_count","type":"long","option":true},"causation_min_measure":{"text":"causation_min_measure","type":"string","option":true},"causation_rule_name":{"text":"causation_rule_name","type":"string","option":true},"causation_suppl_measure":{"text":"causation_suppl_measure","type":"string","option":true},"derived_severity":{"text":"derived_severity","type":"string","option":true},"expire_tm":{"text":"expire_tm","type":"long","option":true},"window":{"text":"window","type":"string","option":true},"metric_id":{"text":"metric_id","type":"string","option":true},"generated_tm":{"text":"unix_timestamp_millisec(now())/1000","type":"number","option":false},"algorithm":{"text":"algorithm","type":"string","option":true},"active_duration":{"text":"active_dur","type":"long","option":true},"threshold_low":{"text":"threshold_low","type":"double","option":true},"threshold_med":{"text":"threshold_med","type":"double","option":true},"threshold_high":{"text":"threshold_high","type":"double","option":true},"factor":{"text":"source1.factor","type":"double","option":false},"peak_score":{"text":"","type":null,"option":false},"threshold_policy":{"text":"threshold_policy","type":"string","option":true},"severity":{"text":"severity","type":"string","option":true},"config_metric_id":{"text":"config_metric_id\n","type":"string","option":true},"dim_keys":{"text":"dim_keys","type":"string","option":true},"dim_values":{"text":"dim_values","type":"string","option":true},"service_name":{"text":"service_name","type":"string","option":true},"sub_service_name":{"text":"sub_service_name","type":"string","option":true},"dim_pattern":{"text":"dim_pattern","type":"string","option":true},"correlation_end_tm":{"text":"correlation_end_tm","type":"long","option":true},"groupable":{"text":"groupable","type":"string","option":true},"mode":{"text":"mode","type":"string","option":true},"contextual_metric_id":{"text":"contextual_metric_id","type":"string","option":true},"contextual_metric_start_tm":{"text":"source1.contextual_metric_start_tm","type":"long","option":true},"contextual_metric_end_tm":{"text":"source1.contextual_metric_end_tm","type":"long","option":true},"contextual_metric_aggr":{"text":"source1.contextual_metric_aggr","type":"double","option":true},"contextual_metric_baseline":{"text":"source1.contextual_metric_baseline","type":"double","option":true},"contextual_metric_deviation":{"text":"source1.contextual_metric_deviation","type":"double","option":true},"reason":{"text":"reason","type":"string","option":true},"action":{"text":"action","type":"string","option":true}}},{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","type":"boolean","option":false}}]},{"id":"fcf3f6ea-ae1a-4a2d-8b57-51536198ac69","internalID":"ea71b892-5a27-48e4-88f6-e0b150da5af4","ref":"EndInstance","desc":"End instance on condition {condition}","bindings":[{"field":"condition","type":"condition","editorType":"sle","literalValue":"$.text","defaultValue":{"text":"true","option":"false","type":"boolean"},"value":{"text":"true","option":"false","type":"boolean"}}]}]}}],"output":[{"_deletable":false,"uid":"0","output":"ip","type":{"name":"viaops.incident_out","kind":"caseclass"},"_id":"b55d219a-157c-4262-8473-a17f8d5a3e01","field":"type"}],"audit":{"name":"3","value":"false"},"outputLatest":{"enable":false,"uid":"","output":"Snapshots","type":{"name":"","kind":"caseclass"},"interval":{"number":"1","unit":"SECONDS"}},"persistState":{"enabled":false}}
</Properties>
            </Model>
        </Node>
        <Node index="2003" uuid="7f8c7344-1ca8-4043-8fcd-1df9d8ab1cb7" type="inPort" label="In" x="140" y="48" width="70" height="40">
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.incident_score_anomaly" referenceType="viaops.incident_score_anomaly">
              <Field name="high_metric_deviation" label="high_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="high_metric_deviation"/>
              <Field name="med_metric_deviation" label="med_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="med_metric_deviation"/>
              <Field name="metric_base_metric_id" label="metric_base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_dim_values" label="metric_dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="anomaly_interval" label="anomaly_interval" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_measure" label="metric_measure" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_baseline" label="metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="config_metric_id" label="config_metric_id" type="string" clazz="" isArray="false" isOptional="false" column="metric_id"/>
              <Field name="threshold_policy" label="threshold_policy" type="string" clazz="" isArray="false" isOptional="false" column="threshold_policy"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false" column="algorithm"/>
              <Field name="emit_notification" label="emit_notification" type="string" clazz="" isArray="false" isOptional="true" column="emit_notification"/>
              <Field name="threshold_high" label="threshold_high" type="double" clazz="" isArray="false" isOptional="true" column="threshold_high"/>
              <Field name="threshold_low" label="threshold_low" type="double" clazz="" isArray="false" isOptional="true" column="threshold_low"/>
              <Field name="high_threshold_period" label="high_threshold_period" type="integer" clazz="" isArray="false" isOptional="true" column="high_threshold_period"/>
              <Field name="expire_after" label="expire_after" type="integer" clazz="" isArray="false" isOptional="true" column="expire_after"/>
              <Field name="cool_down_period" label="cool_down_period" type="integer" clazz="" isArray="false" isOptional="true" column="cool_down_period"/>
              <Field name="warmup_period" label="warmup_period" type="integer" clazz="" isArray="false" isOptional="true" column="warmup_period"/>
              <Field name="warmup_threshold" label="warmup_threshold" type="double" clazz="" isArray="false" isOptional="true" column="warmup_threshold"/>
              <Field name="min_metric_vol" label="min_metric_vol" type="double" clazz="" isArray="false" isOptional="true" column="min_metric_vol"/>
              <Field name="causation_measure" label="causation_measure" type="string" clazz="" isArray="false" isOptional="true" column="causation_measure"/>
              <Field name="causation_top_count" label="causation_top_count" type="integer" clazz="" isArray="false" isOptional="true" column="causation_top_count"/>
              <Field name="causation_min_measure" label="causation_min_measure" type="double" clazz="" isArray="false" isOptional="true" column="causation_min_measure"/>
              <Field name="causation_rule_name" label="causation_rule_name" type="string" clazz="" isArray="false" isOptional="true" column="causation_rule_name"/>
              <Field name="upd_dt" label="upd_dt" type="datetime" clazz="" isArray="false" isOptional="true" column="upd_dt"/>
              <Field name="config_dim_pattern" label="config_dim_pattern" type="string" clazz="" isArray="false" isOptional="false" column="dim_pattern"/>
              <Field name="service_name" label="service_name" type="string" clazz="" isArray="false" isOptional="false" column="service_name"/>
              <Field name="sub_service_name" label="sub_service_name" type="string" clazz="" isArray="false" isOptional="false" column="sub_service_name"/>
              <Field name="correlation_time" label="correlation_time" type="long" clazz="" isArray="false" isOptional="true" column="correlation_time"/>
              <Field name="groupable" label="groupable" type="string" clazz="" isArray="false" isOptional="false" column="groupable"/>
              <Field name="config_base_metric_id" label="config_base_metric_id" type="string" clazz="" isArray="false" isOptional="true" column="base_metric_id"/>
              <Field name="metric_hist_per" label="metric_hist_per" type="long" clazz="" isArray="false" isOptional="false" column="metric_hist_per"/>
              <Field name="max_low_per" label="max_low_per" type="long" clazz="" isArray="false" isOptional="false" column="max_low_per"/>
              <Field name="max_med_per" label="max_med_per" type="long" clazz="" isArray="false" isOptional="false" column="max_med_per"/>
              <Field name="tot_max_low_per" label="tot_max_low_per" type="long" clazz="" isArray="false" isOptional="false" column="tot_max_low_per"/>
              <Field name="tot_max_med_per" label="tot_max_med_per" type="long" clazz="" isArray="false" isOptional="false" column="tot_max_med_per"/>
              <Field name="med_threshold_period" label="med_threshold_period" type="integer" clazz="" isArray="false" isOptional="true" column="med_threshold_period"/>
              <Field name="mode" label="mode" type="string" clazz="" isArray="false" isOptional="true" column="mode"/>
              <Field name="min_metric_deviation" label="min_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="min_metric_deviation"/>
              <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="integer" clazz="" isArray="false" isOptional="true" column="contextual_metric_time_skew"/>
              <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" clazz="" isArray="false" isOptional="true" column="min_contextual_metric_vol"/>
              <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="min_contextual_metric_deviation"/>
              <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="med_contextual_metric_deviation"/>
              <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" clazz="" isArray="false" isOptional="true" column="high_contextual_metric_deviation"/>
              <Field name="window" label="window" type="string" clazz="" isArray="false" isOptional="false" column="window"/>
              <Field name="threshold_med" label="threshold_med" type="double" clazz="" isArray="false" isOptional="true" column="threshold_med"/>
              <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" clazz="" isArray="false" isOptional="true" column="causation_suppl_measure"/>
              <Field name="min_factor" label="min_factor" type="double" clazz="" isArray="false" isOptional="true" column="min_factor"/>
              <Field name="med_factor" label="med_factor" type="double" clazz="" isArray="false" isOptional="true" column="med_factor"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true" column="score_method"/>
              <Field name="max_warmup_period" label="max_warmup_period" type="integer" clazz="" isArray="false" isOptional="true" column="max_warmup_period"/>
              <Field name="late_data_timer" label="late_data_timer" type="integer" clazz="" isArray="false" isOptional="true" column="late_data_timer"/>
              <Field name="kpi_metric_id" label="kpi_metric_id" type="string" clazz="" isArray="false" isOptional="true" column="kpi_metric_id" wrapName="kpi_metric_id"/>
              <Field name="kpi_base_metric_id" label="kpi_base_metric_id" type="string" clazz="" isArray="false" isOptional="true" column="kpi_base_metric_id" wrapName="kpi_base_metric_id"/>
              <Field name="kpi_dim_keys" label="kpi_dim_keys" type="string" clazz="" isArray="false" isOptional="true" column="kpi_dim_keys" wrapName="kpi_dim_keys"/>
              <Field name="kpi_dim_pattern" label="kpi_dim_pattern" type="string" clazz="" isArray="false" isOptional="true" column="kpi_dim_pattern" wrapName="kpi_dim_pattern"/>
              <Field name="contextual_metric_id" label="contextual_metric_id" type="string" clazz="" isArray="false" isOptional="true" column="contextual_metric_id" wrapName="contextual_metric_id"/>
              <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="contextual_metric_mean_baseline" label="contextual_metric_mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.incident_score_anomaly","kind":"caseclass"}}
</Properties>
            </Model>
        </Node>
        <Node index="2004" uuid="b9111791-5827-4be5-8081-2ce8e709d2ff" type="outPort" label="audit" x="531" y="203" width="70" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.incident_in">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5721106c-efe5-428b-8015-f3a4876ab73e">
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="mode" label="mode" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="emit_notification" label="emit_notification" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="anomaly_interval" label="anomaly_interval" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_high" label="threshold_high" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_low" label="threshold_low" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_med" label="threshold_med" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_threshold_period" label="med_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_threshold_period" label="high_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="expire_after" label="expire_after" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="cool_down_period" label="cool_down_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_period" label="warmup_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_threshold" label="warmup_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_vol" label="min_metric_vol" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_deviation" label="min_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_metric_deviation" label="med_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_metric_deviation" label="high_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_measure" label="causation_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_top_count" label="causation_top_count" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_min_measure" label="causation_min_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_rule_name" label="causation_rule_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="factor" label="factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_measure" label="metric_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_baseline" label="metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_id" label="contextual_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="score" label="score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_deviation" label="metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule" label="low_threshold_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule_expr" label="low_threshold_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="warmup_rule" label="warmup_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_rule_expr" label="warmup_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_metric_rule" label="active_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_metric_rule_expr" label="active_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_contextual_metric_rule" label="active_contextual_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_contextual_metric_rule_expr" label="active_contextual_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="contextual_metric_time_skew" label="contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule" label="contextual_metric_time_skew_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule_text" label="contextual_metric_time_skew_rule_text" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_setting_tm" label="config_setting_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_pattern" label="dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_metric_id" label="config_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="service_name" label="service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sub_service_name" label="sub_service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="correlation_time" label="correlation_time" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="groupable" label="groupable" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_history_per" label="metric_history_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_low_per" label="max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_med_per" label="max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_low_per" label="tot_max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_med_per" label="tot_max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_warmup_per" label="max_warmup_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="late_data_timer" label="late_data_timer" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{"type":{"name":"viaops.incident_in","kind":"caseclass"}}
</Properties>
            </Model>
        </Node>
        <Node index="2005" uuid="27873911-8563-4554-8f79-a73b92da4a51" type="outPort" label="incident" x="780" y="53" width="71.375" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.incident_out">
              <DataSource category="#OUTPUT" id="undefined" name="ip" nodeId="43cdd63f-e4f9-459f-81d4-50991c155d24">
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="event_tm" label="event_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="id" label="id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="state" label="state" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="operation" label="operation" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="score" label="score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="peak_score" label="peak_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="derived_severity" label="derived_severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_severity" label="max_severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_measure" label="metric_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_baseline" label="metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="factor" label="factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_deviation" label="metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_id" label="contextual_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_measure" label="causation_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_top_count" label="causation_top_count" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_min_measure" label="causation_min_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_rule_name" label="causation_rule_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="expire_tm" label="expire_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_duration" label="active_duration" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_low" label="threshold_low" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_med" label="threshold_med" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_high" label="threshold_high" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="action" label="action" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_threshold" label="warmup_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_duration" label="warmup_duration" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="cooldown_duration" label="cooldown_duration" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="config_metric_id" label="config_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="dim_pattern" label="dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="service_name" label="service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="sub_service_name" label="sub_service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="correlation_end_tm" label="correlation_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="groupable" label="groupable" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="alternate_id" label="alternate_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="mode" label="mode" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{"type":{"name":"viaops.incident_out","kind":"caseclass"}}
</Properties>
            </Model>
        </Node>
        <Node index="2006" uuid="17bd52de-6b73-4f7f-8110-1cfb215b2296" type="Compute" label="Map VE" x="440" y="100" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.incident_in">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5721106c-efe5-428b-8015-f3a4876ab73e">
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window" label="window" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_policy" label="threshold_policy" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="mode" label="mode" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="emit_notification" label="emit_notification" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_contextual_metric_time_skew" label="max_contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="anomaly_interval" label="anomaly_interval" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="threshold_high" label="threshold_high" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_low" label="threshold_low" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="threshold_med" label="threshold_med" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_threshold_period" label="med_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_threshold_period" label="high_threshold_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="expire_after" label="expire_after" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="cool_down_period" label="cool_down_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_period" label="warmup_period" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_threshold" label="warmup_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_vol" label="min_metric_vol" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_metric_deviation" label="min_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_metric_deviation" label="med_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_metric_deviation" label="high_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_vol" label="min_contextual_metric_vol" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="min_contextual_metric_deviation" label="min_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="med_contextual_metric_deviation" label="med_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="high_contextual_metric_deviation" label="high_contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_measure" label="causation_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_top_count" label="causation_top_count" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_min_measure" label="causation_min_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_rule_name" label="causation_rule_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="causation_suppl_measure" label="causation_suppl_measure" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="factor" label="factor" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_measure" label="metric_measure" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_baseline" label="metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_id" label="contextual_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_start_tm" label="contextual_metric_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_end_tm" label="contextual_metric_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_aggr" label="contextual_metric_aggr" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_baseline" label="contextual_metric_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_median_baseline" label="contextual_metric_median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="score" label="score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_deviation" label="metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_deviation" label="contextual_metric_deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule" label="low_threshold_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="low_threshold_rule_expr" label="low_threshold_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="warmup_rule" label="warmup_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="warmup_rule_expr" label="warmup_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_metric_rule" label="active_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_metric_rule_expr" label="active_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="active_contextual_metric_rule" label="active_contextual_metric_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="active_contextual_metric_rule_expr" label="active_contextual_metric_rule_expr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="contextual_metric_time_skew" label="contextual_metric_time_skew" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule" label="contextual_metric_time_skew_rule" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="contextual_metric_time_skew_rule_text" label="contextual_metric_time_skew_rule_text" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_setting_tm" label="config_setting_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_pattern" label="dim_pattern" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="config_metric_id" label="config_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="service_name" label="service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sub_service_name" label="sub_service_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="correlation_time" label="correlation_time" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="groupable" label="groupable" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_history_per" label="metric_history_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_low_per" label="max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_med_per" label="max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_low_per" label="tot_max_low_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="tot_max_med_per" label="tot_max_med_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="max_warmup_per" label="max_warmup_per" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="late_data_timer" label="late_data_timer" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:VE">
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="window" label="window" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="threshold_policy" label="threshold_policy" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="event_tm" label="event_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="virtual_event_tm" label="virtual_event_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="VE" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="metric_id" outputType="string" alias="metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="window" outputType="string" alias="window" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="threshold_policy" outputType="string" alias="threshold_policy" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="start_tm -1 " outputType="long" alias="event_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="start_tm" outputType="long" alias="virtual_event_tm" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Link srcId="7f8c7344-1ca8-4043-8fcd-1df9d8ab1cb7" srcPort="out:0" tgtId="5721106c-efe5-428b-8015-f3a4876ab73e" tgtPort="in:0"/>
        <Link srcId="5721106c-efe5-428b-8015-f3a4876ab73e" srcPort="out:0" tgtId="43cdd63f-e4f9-459f-81d4-50991c155d24" tgtPort="din:0"/>
        <Link srcId="5721106c-efe5-428b-8015-f3a4876ab73e" srcPort="out:0" tgtId="b9111791-5827-4be5-8081-2ce8e709d2ff" tgtPort="in:0"/>
        <Link srcId="43cdd63f-e4f9-459f-81d4-50991c155d24" srcPort="dout:0" tgtId="27873911-8563-4554-8f79-a73b92da4a51" tgtPort="in:0"/>
        <Link srcId="5721106c-efe5-428b-8015-f3a4876ab73e" srcPort="out:0" tgtId="17bd52de-6b73-4f7f-8110-1cfb215b2296" tgtPort="in:0"/>
        <Link srcId="17bd52de-6b73-4f7f-8110-1cfb215b2296" srcPort="out:0" tgtId="43cdd63f-e4f9-459f-81d4-50991c155d24" tgtPort="din:1"/>
      <Codes>
          <Imports><![CDATA[object IncidentMsgUtils {

  def replaceVars(template: String, vs: Tuple2[String, Any]*): String = {
    var replaced = template
    vs.foreach(x => {
      val key = "%{" + x._1 + "}"
      val v = x._2 match {
        case null => ""
        case None => ""
        case Some(x) => x.toString
        case _ => x._2.toString()
      }
      replaced = replaced.replace(key, v)
    })
    replaced
  }
}

object MsgVars {

  val var_low_threshold = "low_threshold"
  val var_med_threshold = "med_threshold"
  val var_high_threshold = "high_threshold"
  val var_warmup_threshold = "warmup_threshold"
  val var_max_warmup_periods = "max_warmup_periods"
  val var_max_data_interval = "max_data_interval"
  val var_max_cooldown_time = "max_cooldown_time"
  val var_expired_tm_duration="expired_tm_duration"
// simple threshold
  val var_over_low_periods = "over_low_periods"
  val var_over_med_periods = "over_med_periods"
  val var_max_low_periods = "max_low_periods"
  val var_max_med_periods = "max_med_periods"
  val var_tot_over_low_periods = "tot_over_low_periods"
  val var_tot_over_med_periods = "tot_over_med_periods"

//only for deviation
  val var_max_med_time = "max_med_time"
  val var_max_high_time = "max_high_time"
  val var_min_metric_deviation = "min_metric_deviation"
  val var_warmup_period = "warmup_period"
  val var_min_metric_val = "min_metric_val"
}

object IncidentActionMsg {
  val BEGIN = "Begin"
  val INCIDENT_START = "Start of incident "
  val BEGIN_AT = "Begin at"
  val INCIDENT_END = "End of incident "
  val CONTINUE = "Continue"
  val ABORT = "Abort"
  val ESCALATE = "Escalate to"
  val STAY = "Stay at"
  val UPGRADE = "Upgrade to"
  val DOWNGRADE = "Downgrade to"
  val ABORT_AND_RESUME = "Abort Cooldown. Resume at"
  val COMPLETE = "Complete"

  // simple threshold
  val ABORT_AND_ESCALATE = "Abort Cooldown. Escalate to"
}

object SimpleDevMsg {
  // Simple Deviation Msg
  val BEGIN_STAY_LOW_REASON = "&because;Metric deviation greater than low, but less than medium threshold (%{low_threshold} < deviation <= %{med_threshold})."
  val BEGIN_STAY_MED_REASON = "&because;Metric deviation greater than medium, but less than high threshold (%{med_threshold} < deviation <= %{high_threshold})."
  val BEGIN_STAY_HIGH_REASON = "&because;Metric deviation greater than high threshold (deviation > %{high_threshold})."
  val UPGRADE_TO_MED_REASON = "&because;Metric deviation greater than medium, but less than high threshold (%{med_threshold} < deviation <= %{high_threshold})."
  val UPGRADE_TO_HIGH_REASON = "&because;Metric deviation greater than high threshold (deviation > %{high_threshold})."
  val ESCALATE_TO_MED_REASON_TIME = "&because;Active time  %{max_med_time}s."
  val ESCALATE_TO_HIGH_REASON_TIME = "&because;Active time  %{max_high_time}s."
  val ABORT_COOLDOWN_REASON = "&because;Metric deviation and value exceed minimum. (metric deviation > %{min_metric_deviation} AND metric_measure > %{min_metric_val})."
  val DOWNGRADE_LOW_REASON = "&because;Metric deviation greater than low, but less than medium threshold (%{low_threshold} < deviation <= %{med_threshold})."
  val DOWNGRADE_MED_REASON = "&because;Metric deviation greater than medium, but less than high threshold (%{med_threshold} < deviation <= %{high_threshold})."
  val BEGIN_STAY_WARMUP_REASON_QUAL = "&because;Metric deviation and value qualify, but additional qualified time required. (deviation > %{low_threshold}; metric_measure > %{min_metric_val}; qualified period < %{warmup_period}s)."
  val BEGIN_STAY_WARMUP_REASON_UNQUAL = "&because;Metric deviation or value does not qualify, but max qualification period not exceeded. (deviation > %{low_threshold}; metric_measure > %{min_metric_val}; qualified period < %{warmup_period}s)."
  val ESCALATE_TO_LOW_REASON = "&because;Qualified period met (qualified period >= %{warmup_period}s)."
  val ABORT_WARMUP = "&because;Max qualification period exceeded. (qualified period >= %{max_warmup_periods}s)"
  val TIMEOUT_REASON = "&because;No additional data received in the max data interval (time since last data > %{max_data_interval}s)."
  val EXPIRED_REASON = "&because;Expired. Exceeded maximum incident lifetime (time > %{expired_tm_duration}s)"
  val STAY_RESUME_ESCALATE_MED = "&because;Previously escalated to Medium."
  val STAY_RESUME_ESCALATE_HIGH = "&because;Previously escalated to High."
  val BEGIN_STAY_COOLDOWN_REASON = "&because;Metric deviation or value beneath minimum. (metric deviation <= %{min_metric_deviation} OR metric_measure <= %{min_metric_val})."
  val COMPLETE_COOLDOWN_REASON = "&because;Cooldown conditions met or no additional data received for more than cooldown period (cooldown time >=  %{max_cooldown_time}s)."
  val ARTIFICIAL_LOW_REASON = "&because;Artificial Low. Metric deviation exceeds minimum, but less than low threshold. (%{low_threshold} >= metric deviation > %{min_metric_deviation})."
}
]]></Imports>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[]</Properties>
      <Types>[{"name":"VE","namespace":"","schema":[{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"window","type":"string","_isOptional":false,"_isArray":false},{"name":"threshold_policy","type":"string","_isOptional":false,"_isArray":false},{"name":"event_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"virtual_event_tm","type":"long","_isOptional":false,"_isArray":false}]}]</Types>
      </Flow>
    </Flows>
  </ModelInfo>
</DataPipeModel>